I0401 05:50:23.542438 140613926377280 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_nesterov/criteo1tb_jax.
I0401 05:50:23.914650 140613926377280 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0401 05:50:24.827645 140613926377280 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: CUDA Host Interpreter
I0401 05:50:24.828435 140613926377280 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0401 05:50:24.833945 140613926377280 submission_runner.py:511] Using RNG seed 2791993634
I0401 05:50:27.281389 140613926377280 submission_runner.py:520] --- Tuning run 1/1 ---
I0401 05:50:27.281624 140613926377280 submission_runner.py:525] Creating tuning directory at /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1.
I0401 05:50:27.281847 140613926377280 logger_utils.py:84] Saving hparams to /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/hparams.json.
I0401 05:50:27.411846 140613926377280 submission_runner.py:230] Starting train once: RAM USED (GB) 4.126773248
I0401 05:50:27.412024 140613926377280 submission_runner.py:231] Initializing dataset.
I0401 05:50:27.412190 140613926377280 submission_runner.py:239] After Initializing dataset: RAM USED (GB) 4.126773248
I0401 05:50:27.412256 140613926377280 submission_runner.py:240] Initializing model.
I0401 05:50:33.833831 140613926377280 submission_runner.py:251] After Initializing model: RAM USED (GB) 7.923781632
I0401 05:50:33.834077 140613926377280 submission_runner.py:252] Initializing optimizer.
I0401 05:50:35.656776 140613926377280 submission_runner.py:260] After Initializing metrics bundle: RAM USED (GB) 7.926898688
I0401 05:50:35.657005 140613926377280 submission_runner.py:261] Initializing metrics bundle.
I0401 05:50:35.657055 140613926377280 submission_runner.py:276] Initializing checkpoint and logger.
I0401 05:50:35.658361 140613926377280 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1 with prefix checkpoint_
I0401 05:50:35.658680 140613926377280 logger_utils.py:231] Unable to record workload.train_mean information. Continuing without it.
I0401 05:50:35.658747 140613926377280 logger_utils.py:231] Unable to record workload.train_stddev information. Continuing without it.
I0401 05:50:36.631640 140613926377280 submission_runner.py:297] Saving meta data to /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/meta_data_0.json.
I0401 05:50:36.632753 140613926377280 submission_runner.py:300] Saving flags to /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/flags_0.json.
I0401 05:50:36.685131 140613926377280 submission_runner.py:305] After checkpoint and logger metrics bundle: RAM USED (GB) 7.963066368
I0401 05:50:36.685434 140613926377280 submission_runner.py:312] Before starting training loop and logger metrics bundle: RAM USED (GB) 7.963066368
I0401 05:50:36.685497 140613926377280 submission_runner.py:313] Starting training loop.
I0401 05:53:04.214595 140613926377280 submission_runner.py:335] After dataselection batch at step 0: RAM USED (GB) 46.18125312
I0401 05:53:26.107416 140408076101376 logging_writer.py:48] [0] global_step=0, grad_norm=2.383157253265381, loss=0.2539079189300537
I0401 05:53:26.127246 140613926377280 submission_runner.py:352] After update parameters step 0: RAM USED (GB) 53.483954176
I0401 05:53:26.127454 140613926377280 submission_runner.py:373] Before eval at step 1: RAM USED (GB) 53.483954176
I0401 05:53:26.127529 140613926377280 spec.py:298] Evaluating on the training split.
I0401 06:03:11.153610 140613926377280 spec.py:310] Evaluating on the validation split.
I0401 06:07:52.981306 140613926377280 spec.py:326] Evaluating on the test split.
I0401 06:12:56.297908 140613926377280 submission_runner.py:382] Time since start: 169.44s, 	Step: 1, 	{'train/loss': 0.25443755676853386, 'validation/loss': 0.2565852584269663, 'validation/num_examples': 89000000, 'test/loss': 0.2571114570871904, 'test/num_examples': 89274637}
I0401 06:12:56.298911 140613926377280 submission_runner.py:396] After eval at step 1: RAM USED (GB) 95.367041024
I0401 06:12:56.308855 140351829546752 logging_writer.py:48] [1] global_step=1, preemption_count=0, score=169.244970, test/loss=0.257111, test/num_examples=89274637, total_duration=169.442024, train/loss=0.254438, validation/loss=0.256585, validation/num_examples=89000000
I0401 06:13:00.451867 140613926377280 checkpoints.py:356] Saving checkpoint at step: 1
I0401 06:13:24.918981 140613926377280 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1
I0401 06:13:25.268536 140613926377280 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1.
I0401 06:13:25.614565 140613926377280 submission_runner.py:416] After logging and checkpointing eval at step 1: RAM USED (GB) 95.586992128
I0401 06:13:25.617432 140613926377280 submission_runner.py:335] After dataselection batch at step 1: RAM USED (GB) 95.545847808
I0401 06:13:25.659548 140613926377280 submission_runner.py:352] After update parameters step 1: RAM USED (GB) 95.544188928
I0401 06:15:03.746747 140351746602752 logging_writer.py:48] [100] global_step=100, grad_norm=0.005014434922486544, loss=0.13744738698005676
I0401 06:17:15.191834 140351713031936 logging_writer.py:48] [200] global_step=200, grad_norm=0.006377323996275663, loss=0.13716989755630493
I0401 06:19:15.833845 140351746602752 logging_writer.py:48] [300] global_step=300, grad_norm=0.015873024240136147, loss=0.1362217366695404
I0401 06:21:38.348778 140351713031936 logging_writer.py:48] [400] global_step=400, grad_norm=0.008553817868232727, loss=0.13658592104911804
I0401 06:22:25.635026 140613926377280 submission_runner.py:373] Before eval at step 441: RAM USED (GB) 102.5234944
I0401 06:22:25.635230 140613926377280 spec.py:298] Evaluating on the training split.
I0401 06:33:23.505025 140613926377280 spec.py:310] Evaluating on the validation split.
I0401 06:37:06.112592 140613926377280 spec.py:326] Evaluating on the test split.
I0401 06:41:00.648332 140613926377280 submission_runner.py:382] Time since start: 1908.95s, 	Step: 441, 	{'train/loss': 0.13654210060462083, 'validation/loss': 0.1366578426966292, 'validation/num_examples': 89000000, 'test/loss': 0.14005299175845431, 'test/num_examples': 89274637}
I0401 06:41:00.648763 140613926377280 submission_runner.py:396] After eval at step 441: RAM USED (GB) 109.417381888
I0401 06:41:00.655574 140355982821120 logging_writer.py:48] [441] global_step=441, preemption_count=0, score=707.374632, test/loss=0.140053, test/num_examples=89274637, total_duration=1908.949346, train/loss=0.136542, validation/loss=0.136658, validation/num_examples=89000000
I0401 06:41:04.867179 140613926377280 checkpoints.py:356] Saving checkpoint at step: 441
I0401 06:41:29.121786 140613926377280 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_441
I0401 06:41:29.476870 140613926377280 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_441.
I0401 06:41:29.827833 140613926377280 submission_runner.py:416] After logging and checkpointing eval at step 441: RAM USED (GB) 109.43277056
I0401 06:42:10.009234 140355974428416 logging_writer.py:48] [500] global_step=500, grad_norm=0.007839713245630264, loss=0.1367335170507431
I0401 06:44:10.272603 140355932464896 logging_writer.py:48] [600] global_step=600, grad_norm=0.01737312786281109, loss=0.13518095016479492
I0401 06:46:09.135039 140355974428416 logging_writer.py:48] [700] global_step=700, grad_norm=0.0055225505493581295, loss=0.1327831745147705
I0401 06:48:03.310621 140613926377280 submission_runner.py:373] Before eval at step 800: RAM USED (GB) 110.026407936
I0401 06:48:03.310821 140613926377280 spec.py:298] Evaluating on the training split.
I0401 06:58:12.516499 140613926377280 spec.py:310] Evaluating on the validation split.
I0401 07:01:53.004943 140613926377280 spec.py:326] Evaluating on the test split.
I0401 07:06:38.943764 140613926377280 submission_runner.py:382] Time since start: 3446.62s, 	Step: 800, 	{'train/loss': 0.13431447459284745, 'validation/loss': 0.1344470561797753, 'validation/num_examples': 89000000, 'test/loss': 0.13765839227103213, 'test/num_examples': 89274637}
I0401 07:06:38.944645 140613926377280 submission_runner.py:396] After eval at step 800: RAM USED (GB) 113.66516736
I0401 07:06:38.952168 140390151722752 logging_writer.py:48] [800] global_step=800, preemption_count=0, score=1098.696634, test/loss=0.137658, test/num_examples=89274637, total_duration=3446.624957, train/loss=0.134314, validation/loss=0.134447, validation/num_examples=89000000
I0401 07:06:43.086556 140613926377280 checkpoints.py:356] Saving checkpoint at step: 800
I0401 07:07:06.738126 140613926377280 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_800
I0401 07:07:07.085652 140613926377280 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_800.
I0401 07:07:07.417061 140613926377280 submission_runner.py:416] After logging and checkpointing eval at step 800: RAM USED (GB) 113.689780224
I0401 07:07:07.423149 140390143330048 logging_writer.py:48] [800] global_step=800, preemption_count=0, score=1098.696634
I0401 07:07:11.370884 140613926377280 checkpoints.py:356] Saving checkpoint at step: 800
I0401 07:07:44.034768 140613926377280 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_800
I0401 07:07:44.370069 140613926377280 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_800.
I0401 07:09:15.249099 140613926377280 submission_runner.py:550] Tuning trial 1/1
I0401 07:09:15.249355 140613926377280 submission_runner.py:551] Hyperparameters: Hyperparameters(learning_rate=0.4394877561366806, one_minus_beta1=0.07113602458522507, warmup_factor=0.05, weight_decay=9.611851572925426e-07, label_smoothing=0.2, dropout_rate=0.0, decay_steps_factor=0.9, end_factor=0.001)
I0401 07:09:15.250825 140613926377280 submission_runner.py:552] Metrics: {'eval_results': [(1, {'train/loss': 0.25443755676853386, 'validation/loss': 0.2565852584269663, 'validation/num_examples': 89000000, 'test/loss': 0.2571114570871904, 'test/num_examples': 89274637, 'score': 169.24496984481812, 'total_duration': 169.44202399253845, 'global_step': 1, 'preemption_count': 0}), (441, {'train/loss': 0.13654210060462083, 'validation/loss': 0.1366578426966292, 'validation/num_examples': 89000000, 'test/loss': 0.14005299175845431, 'test/num_examples': 89274637, 'score': 707.3746316432953, 'total_duration': 1908.9493458271027, 'global_step': 441, 'preemption_count': 0}), (800, {'train/loss': 0.13431447459284745, 'validation/loss': 0.1344470561797753, 'validation/num_examples': 89000000, 'test/loss': 0.13765839227103213, 'test/num_examples': 89274637, 'score': 1098.6966338157654, 'total_duration': 3446.6249573230743, 'global_step': 800, 'preemption_count': 0})], 'global_step': 800}
I0401 07:09:15.250977 140613926377280 submission_runner.py:553] Timing: 1098.6966338157654
I0401 07:09:15.251030 140613926377280 submission_runner.py:554] ====================
I0401 07:09:15.251137 140613926377280 submission_runner.py:613] Final criteo1tb score: 1098.6966338157654
