I0419 04:54:27.952968 140130179036992 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax.
I0419 04:54:28.096562 140130179036992 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0419 04:54:28.953323 140130179036992 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Interpreter Host CUDA
I0419 04:54:28.954376 140130179036992 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0419 04:54:28.959127 140130179036992 submission_runner.py:528] Using RNG seed 3585336537
I0419 04:54:31.589530 140130179036992 submission_runner.py:537] --- Tuning run 1/1 ---
I0419 04:54:31.589709 140130179036992 submission_runner.py:542] Creating tuning directory at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1.
I0419 04:54:31.589881 140130179036992 logger_utils.py:83] Saving hparams to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/hparams.json.
I0419 04:54:31.714548 140130179036992 submission_runner.py:232] Initializing dataset.
I0419 04:54:31.714734 140130179036992 submission_runner.py:239] Initializing model.
I0419 04:54:37.642763 140130179036992 submission_runner.py:249] Initializing optimizer.
I0419 04:54:39.193800 140130179036992 submission_runner.py:256] Initializing metrics bundle.
I0419 04:54:39.194002 140130179036992 submission_runner.py:273] Initializing checkpoint and logger.
I0419 04:54:39.198086 140130179036992 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1 with prefix checkpoint_
I0419 04:54:39.198351 140130179036992 logger_utils.py:230] Unable to record workload.train_mean information. Continuing without it.
I0419 04:54:39.198414 140130179036992 logger_utils.py:230] Unable to record workload.train_stddev information. Continuing without it.
I0419 04:54:39.822928 140130179036992 submission_runner.py:294] Saving meta data to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/meta_data_0.json.
I0419 04:54:39.823892 140130179036992 submission_runner.py:297] Saving flags to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/flags_0.json.
I0419 04:54:39.873176 140130179036992 submission_runner.py:309] Starting training loop.
I0419 04:57:35.670787 139922887407360 logging_writer.py:48] [0] global_step=0, grad_norm=10.82565975189209, loss=1.3481110334396362
I0419 04:57:35.712116 140130179036992 spec.py:298] Evaluating on the training split.
I0419 05:06:22.609614 140130179036992 spec.py:310] Evaluating on the validation split.
I0419 05:10:34.540961 140130179036992 spec.py:326] Evaluating on the test split.
I0419 05:15:07.676019 140130179036992 submission_runner.py:406] Time since start: 1227.80s, 	Step: 1, 	{'train/loss': 1.3482253725165563, 'validation/loss': 1.3452153707865169, 'validation/num_examples': 89000000, 'test/loss': 1.346617897757456, 'test/num_examples': 89274637, 'score': 175.83870577812195, 'total_duration': 1227.8026905059814, 'accumulated_submission_time': 175.83870577812195, 'accumulated_eval_time': 1051.9637711048126, 'accumulated_logging_time': 0}
I0419 05:15:07.691856 139867882415872 logging_writer.py:48] [1] accumulated_eval_time=1051.963771, accumulated_logging_time=0, accumulated_submission_time=175.838706, global_step=1, preemption_count=0, score=175.838706, test/loss=1.346618, test/num_examples=89274637, total_duration=1227.802691, train/loss=1.348225, validation/loss=1.345215, validation/num_examples=89000000
I0419 05:15:09.294994 140130179036992 checkpoints.py:356] Saving checkpoint at step: 1
I0419 05:15:19.799133 140130179036992 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1
I0419 05:15:19.807488 140130179036992 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1.
I0419 05:16:47.239753 139867874023168 logging_writer.py:48] [100] global_step=100, grad_norm=0.20719711482524872, loss=0.1379166543483734
I0419 05:18:47.452198 139867840452352 logging_writer.py:48] [200] global_step=200, grad_norm=0.010449985973536968, loss=0.13639980554580688
I0419 05:21:01.309441 139867874023168 logging_writer.py:48] [300] global_step=300, grad_norm=0.026081345975399017, loss=0.13589981198310852
I0419 05:22:56.393480 139867840452352 logging_writer.py:48] [400] global_step=400, grad_norm=0.061185572296381, loss=0.13718266785144806
I0419 05:24:20.340421 140130179036992 spec.py:298] Evaluating on the training split.
I0419 05:33:50.507645 140130179036992 spec.py:310] Evaluating on the validation split.
I0419 05:37:35.596828 140130179036992 spec.py:326] Evaluating on the test split.
I0419 05:41:56.351049 140130179036992 submission_runner.py:406] Time since start: 2836.48s, 	Step: 476, 	{'train/loss': 0.13649225971819812, 'validation/loss': 0.13645434831460673, 'validation/num_examples': 89000000, 'test/loss': 0.13987512489129472, 'test/num_examples': 89274637, 'score': 716.3579502105713, 'total_duration': 2836.477712392807, 'accumulated_submission_time': 716.3579502105713, 'accumulated_eval_time': 2107.9742596149445, 'accumulated_logging_time': 12.139519691467285}
I0419 05:41:56.360327 139915195033344 logging_writer.py:48] [476] accumulated_eval_time=2107.974260, accumulated_logging_time=12.139520, accumulated_submission_time=716.357950, global_step=476, preemption_count=0, score=716.357950, test/loss=0.139875, test/num_examples=89274637, total_duration=2836.477712, train/loss=0.136492, validation/loss=0.136454, validation/num_examples=89000000
I0419 05:42:01.416172 140130179036992 checkpoints.py:356] Saving checkpoint at step: 476
I0419 05:42:29.321085 140130179036992 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_476
I0419 05:42:29.510025 140130179036992 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_476.
I0419 05:42:32.182022 139915186640640 logging_writer.py:48] [500] global_step=500, grad_norm=0.041668910533189774, loss=0.13900847733020782
I0419 05:44:22.499370 139906569807616 logging_writer.py:48] [600] global_step=600, grad_norm=0.043135419487953186, loss=0.13663576543331146
I0419 05:46:13.269437 139915186640640 logging_writer.py:48] [700] global_step=700, grad_norm=0.04133078455924988, loss=0.13510356843471527
I0419 05:48:00.158321 139906569807616 logging_writer.py:48] [800] global_step=800, grad_norm=0.02024701051414013, loss=0.1343493014574051
I0419 05:50:06.784142 139915186640640 logging_writer.py:48] [900] global_step=900, grad_norm=0.017837893217802048, loss=0.1326134204864502
I0419 05:51:30.305706 140130179036992 spec.py:298] Evaluating on the training split.
I0419 06:01:14.230068 140130179036992 spec.py:310] Evaluating on the validation split.
I0419 06:04:54.837293 140130179036992 spec.py:326] Evaluating on the test split.
I0419 06:09:27.948015 140130179036992 submission_runner.py:406] Time since start: 4488.07s, 	Step: 976, 	{'train/loss': 0.13431477774759704, 'validation/loss': 0.13476994382022472, 'validation/num_examples': 89000000, 'test/loss': 0.13795279839670477, 'test/num_examples': 89274637, 'score': 1256.9290435314178, 'total_duration': 4488.074726104736, 'accumulated_submission_time': 1256.9290435314178, 'accumulated_eval_time': 3185.6164746284485, 'accumulated_logging_time': 45.517648220062256}
I0419 06:09:27.956959 139866339796736 logging_writer.py:48] [976] accumulated_eval_time=3185.616475, accumulated_logging_time=45.517648, accumulated_submission_time=1256.929044, global_step=976, preemption_count=0, score=1256.929044, test/loss=0.137953, test/num_examples=89274637, total_duration=4488.074726, train/loss=0.134315, validation/loss=0.134770, validation/num_examples=89000000
I0419 06:09:31.514746 140130179036992 checkpoints.py:356] Saving checkpoint at step: 976
I0419 06:09:51.807514 140130179036992 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_976
I0419 06:09:51.987338 140130179036992 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_976.
I0419 06:09:54.622201 139866331404032 logging_writer.py:48] [1000] global_step=1000, grad_norm=0.008379694074392319, loss=0.13236722350120544
I0419 06:11:42.785908 139866205579008 logging_writer.py:48] [1100] global_step=1100, grad_norm=0.10918045789003372, loss=0.13408631086349487
I0419 06:13:43.453976 139866331404032 logging_writer.py:48] [1200] global_step=1200, grad_norm=0.0864117220044136, loss=0.13145770132541656
I0419 06:15:34.806679 139866205579008 logging_writer.py:48] [1300] global_step=1300, grad_norm=0.01773572899401188, loss=0.13027498126029968
I0419 06:17:29.833221 139866331404032 logging_writer.py:48] [1400] global_step=1400, grad_norm=0.014825601130723953, loss=0.13077150285243988
I0419 06:18:52.218684 140130179036992 spec.py:298] Evaluating on the training split.
I0419 06:28:50.426332 140130179036992 spec.py:310] Evaluating on the validation split.
I0419 06:32:54.238253 140130179036992 spec.py:326] Evaluating on the test split.
I0419 06:36:49.356182 140130179036992 submission_runner.py:406] Time since start: 6129.48s, 	Step: 1478, 	{'train/loss': 0.12968798504759935, 'validation/loss': 0.1299368202247191, 'validation/num_examples': 89000000, 'test/loss': 0.13249963704697001, 'test/num_examples': 89274637, 'score': 1796.9626359939575, 'total_duration': 6129.482840061188, 'accumulated_submission_time': 1796.9626359939575, 'accumulated_eval_time': 4262.75382065773, 'accumulated_logging_time': 69.74956631660461}
I0419 06:36:49.376869 139866205579008 logging_writer.py:48] [1478] accumulated_eval_time=4262.753821, accumulated_logging_time=69.749566, accumulated_submission_time=1796.962636, global_step=1478, preemption_count=0, score=1796.962636, test/loss=0.132500, test/num_examples=89274637, total_duration=6129.482840, train/loss=0.129688, validation/loss=0.129937, validation/num_examples=89000000
I0419 06:36:53.001580 140130179036992 checkpoints.py:356] Saving checkpoint at step: 1478
I0419 06:37:13.289654 140130179036992 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1478
I0419 06:37:13.486570 140130179036992 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1478.
I0419 06:37:15.944375 139866331404032 logging_writer.py:48] [1500] global_step=1500, grad_norm=0.09584978967905045, loss=0.1325177550315857
I0419 06:39:28.781882 140130179036992 spec.py:298] Evaluating on the training split.
I0419 06:49:19.754212 140130179036992 spec.py:310] Evaluating on the validation split.
I0419 06:53:05.273196 140130179036992 spec.py:326] Evaluating on the test split.
I0419 06:56:51.713535 140130179036992 submission_runner.py:406] Time since start: 7331.84s, 	Step: 1600, 	{'train/loss': 0.12899013404200585, 'validation/loss': 0.1295493820224719, 'validation/num_examples': 89000000, 'test/loss': 0.13201887340073978, 'test/num_examples': 89274637, 'score': 1932.0619111061096, 'total_duration': 7331.840259552002, 'accumulated_submission_time': 1932.0619111061096, 'accumulated_eval_time': 5305.685388088226, 'accumulated_logging_time': 94.07458019256592}
I0419 06:56:51.722605 139857800185600 logging_writer.py:48] [1600] accumulated_eval_time=5305.685388, accumulated_logging_time=94.074580, accumulated_submission_time=1932.061911, global_step=1600, preemption_count=0, score=1932.061911, test/loss=0.132019, test/num_examples=89274637, total_duration=7331.840260, train/loss=0.128990, validation/loss=0.129549, validation/num_examples=89000000
I0419 06:56:56.701505 140130179036992 checkpoints.py:356] Saving checkpoint at step: 1600
I0419 06:57:25.072742 140130179036992 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600
I0419 06:57:25.287726 140130179036992 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600.
I0419 06:57:25.509517 139857791792896 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=1932.061911
I0419 06:57:30.264808 140130179036992 checkpoints.py:356] Saving checkpoint at step: 1600
I0419 06:58:03.140714 140130179036992 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600
I0419 06:58:03.344132 140130179036992 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600.
I0419 06:59:56.115600 140130179036992 submission_runner.py:567] Tuning trial 1/1
I0419 06:59:56.117452 140130179036992 submission_runner.py:568] Hyperparameters: Hyperparameters(learning_rate=0.4394877561366806, one_minus_beta1=0.07113602458522507, warmup_factor=0.05, weight_decay=9.611851572925426e-07, label_smoothing=0.2, dropout_rate=0.0, decay_steps_factor=0.9, end_factor=0.001)
I0419 06:59:56.129278 140130179036992 submission_runner.py:569] Metrics: {'eval_results': [(1, {'train/loss': 1.3482253725165563, 'validation/loss': 1.3452153707865169, 'validation/num_examples': 89000000, 'test/loss': 1.346617897757456, 'test/num_examples': 89274637, 'score': 175.83870577812195, 'total_duration': 1227.8026905059814, 'accumulated_submission_time': 175.83870577812195, 'accumulated_eval_time': 1051.9637711048126, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (476, {'train/loss': 0.13649225971819812, 'validation/loss': 0.13645434831460673, 'validation/num_examples': 89000000, 'test/loss': 0.13987512489129472, 'test/num_examples': 89274637, 'score': 716.3579502105713, 'total_duration': 2836.477712392807, 'accumulated_submission_time': 716.3579502105713, 'accumulated_eval_time': 2107.9742596149445, 'accumulated_logging_time': 12.139519691467285, 'global_step': 476, 'preemption_count': 0}), (976, {'train/loss': 0.13431477774759704, 'validation/loss': 0.13476994382022472, 'validation/num_examples': 89000000, 'test/loss': 0.13795279839670477, 'test/num_examples': 89274637, 'score': 1256.9290435314178, 'total_duration': 4488.074726104736, 'accumulated_submission_time': 1256.9290435314178, 'accumulated_eval_time': 3185.6164746284485, 'accumulated_logging_time': 45.517648220062256, 'global_step': 976, 'preemption_count': 0}), (1478, {'train/loss': 0.12968798504759935, 'validation/loss': 0.1299368202247191, 'validation/num_examples': 89000000, 'test/loss': 0.13249963704697001, 'test/num_examples': 89274637, 'score': 1796.9626359939575, 'total_duration': 6129.482840061188, 'accumulated_submission_time': 1796.9626359939575, 'accumulated_eval_time': 4262.75382065773, 'accumulated_logging_time': 69.74956631660461, 'global_step': 1478, 'preemption_count': 0}), (1600, {'train/loss': 0.12899013404200585, 'validation/loss': 0.1295493820224719, 'validation/num_examples': 89000000, 'test/loss': 0.13201887340073978, 'test/num_examples': 89274637, 'score': 1932.0619111061096, 'total_duration': 7331.840259552002, 'accumulated_submission_time': 1932.0619111061096, 'accumulated_eval_time': 5305.685388088226, 'accumulated_logging_time': 94.07458019256592, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0419 06:59:56.129446 140130179036992 submission_runner.py:570] Timing: 1932.0619111061096
I0419 06:59:56.129497 140130179036992 submission_runner.py:571] ====================
I0419 06:59:56.129613 140130179036992 submission_runner.py:631] Final criteo1tb score: 1932.0619111061096
