I0426 09:21:58.936313 139705133524800 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax.
I0426 09:21:59.080034 139705133524800 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0426 09:21:59.963421 139705133524800 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Host Interpreter CUDA
I0426 09:21:59.964176 139705133524800 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0426 09:21:59.968441 139705133524800 submission_runner.py:528] Using RNG seed 1711327489
I0426 09:22:02.641101 139705133524800 submission_runner.py:537] --- Tuning run 1/1 ---
I0426 09:22:02.641309 139705133524800 submission_runner.py:542] Creating tuning directory at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1.
I0426 09:22:02.641678 139705133524800 logger_utils.py:83] Saving hparams to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/hparams.json.
I0426 09:22:02.770107 139705133524800 submission_runner.py:232] Initializing dataset.
I0426 09:22:02.770327 139705133524800 submission_runner.py:239] Initializing model.
I0426 09:22:08.904108 139705133524800 submission_runner.py:249] Initializing optimizer.
I0426 09:22:10.528439 139705133524800 submission_runner.py:256] Initializing metrics bundle.
I0426 09:22:10.528654 139705133524800 submission_runner.py:273] Initializing checkpoint and logger.
I0426 09:22:10.532615 139705133524800 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1 with prefix checkpoint_
I0426 09:22:10.532898 139705133524800 logger_utils.py:230] Unable to record workload.train_mean information. Continuing without it.
I0426 09:22:10.532967 139705133524800 logger_utils.py:230] Unable to record workload.train_stddev information. Continuing without it.
I0426 09:22:11.271751 139705133524800 submission_runner.py:294] Saving meta data to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/meta_data_0.json.
I0426 09:22:11.272736 139705133524800 submission_runner.py:297] Saving flags to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/flags_0.json.
I0426 09:22:11.321460 139705133524800 submission_runner.py:309] Starting training loop.
I0426 09:24:58.624925 139499272128256 logging_writer.py:48] [0] global_step=0, grad_norm=7.997453212738037, loss=1.5756944417953491
I0426 09:24:58.634848 139705133524800 spec.py:298] Evaluating on the training split.
I0426 09:35:11.359990 139705133524800 spec.py:310] Evaluating on the validation split.
I0426 09:39:35.779759 139705133524800 spec.py:326] Evaluating on the test split.
I0426 09:44:19.387044 139705133524800 submission_runner.py:406] Time since start: 1328.07s, 	Step: 1, 	{'train/loss': 1.574463070272259, 'validation/loss': 1.5822444943820224, 'validation/num_examples': 89000000, 'test/loss': 1.5753041258515563, 'test/num_examples': 89274637, 'score': 167.31317567825317, 'total_duration': 1328.0654611587524, 'accumulated_submission_time': 167.31317567825317, 'accumulated_eval_time': 1160.752079963684, 'accumulated_logging_time': 0}
I0426 09:44:19.404360 139446582245120 logging_writer.py:48] [1] accumulated_eval_time=1160.752080, accumulated_logging_time=0, accumulated_submission_time=167.313176, global_step=1, preemption_count=0, score=167.313176, test/loss=1.575304, test/num_examples=89274637, total_duration=1328.065461, train/loss=1.574463, validation/loss=1.582244, validation/num_examples=89000000
I0426 09:44:21.511933 139705133524800 checkpoints.py:356] Saving checkpoint at step: 1
I0426 09:44:34.188381 139705133524800 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1
I0426 09:44:34.198781 139705133524800 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1.
I0426 09:46:07.462712 139446573852416 logging_writer.py:48] [100] global_step=100, grad_norm=0.017764832824468613, loss=0.1384814828634262
I0426 09:48:13.260890 139446540281600 logging_writer.py:48] [200] global_step=200, grad_norm=0.0073950020596385, loss=0.13892723619937897
I0426 09:50:21.966912 139446573852416 logging_writer.py:48] [300] global_step=300, grad_norm=0.013094726018607616, loss=0.13668785989284515
I0426 09:52:31.890370 139446540281600 logging_writer.py:48] [400] global_step=400, grad_norm=0.1506490707397461, loss=0.13810193538665771
I0426 09:53:35.303538 139705133524800 spec.py:298] Evaluating on the training split.
I0426 10:04:24.025217 139705133524800 spec.py:310] Evaluating on the validation split.
I0426 10:07:53.237996 139705133524800 spec.py:326] Evaluating on the test split.
I0426 10:11:57.820668 139705133524800 submission_runner.py:406] Time since start: 2986.50s, 	Step: 450, 	{'train/loss': 0.13886464773687568, 'validation/loss': 0.13993039325842696, 'validation/num_examples': 89000000, 'test/loss': 0.14351891456024626, 'test/num_examples': 89274637, 'score': 708.403137922287, 'total_duration': 2986.4991025924683, 'accumulated_submission_time': 708.403137922287, 'accumulated_eval_time': 2263.269135951996, 'accumulated_logging_time': 14.821715593338013}
I0426 10:11:57.828830 139485631211264 logging_writer.py:48] [450] accumulated_eval_time=2263.269136, accumulated_logging_time=14.821716, accumulated_submission_time=708.403138, global_step=450, preemption_count=0, score=708.403138, test/loss=0.143519, test/num_examples=89274637, total_duration=2986.499103, train/loss=0.138865, validation/loss=0.139930, validation/num_examples=89000000
I0426 10:12:02.051313 139705133524800 checkpoints.py:356] Saving checkpoint at step: 450
I0426 10:12:24.352971 139705133524800 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_450
I0426 10:12:24.536134 139705133524800 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_450.
I0426 10:13:00.734487 139485622818560 logging_writer.py:48] [500] global_step=500, grad_norm=0.05849945917725563, loss=0.13796675205230713
I0426 10:15:11.556977 139481917462272 logging_writer.py:48] [600] global_step=600, grad_norm=0.07157710194587708, loss=0.13946154713630676
I0426 10:17:21.526032 139485622818560 logging_writer.py:48] [700] global_step=700, grad_norm=0.03312072902917862, loss=0.13595353066921234
I0426 10:19:32.937353 139481917462272 logging_writer.py:48] [800] global_step=800, grad_norm=0.059493109583854675, loss=0.1369587630033493
I0426 10:21:26.501273 139705133524800 spec.py:298] Evaluating on the training split.
I0426 10:32:20.116283 139705133524800 spec.py:310] Evaluating on the validation split.
I0426 10:36:33.392859 139705133524800 spec.py:326] Evaluating on the test split.
I0426 10:41:15.379662 139705133524800 submission_runner.py:406] Time since start: 4744.06s, 	Step: 886, 	{'train/loss': 0.13444898547803416, 'validation/loss': 0.13468531460674157, 'validation/num_examples': 89000000, 'test/loss': 0.13795685329977875, 'test/num_examples': 89274637, 'score': 1250.1547470092773, 'total_duration': 4744.05810213089, 'accumulated_submission_time': 1250.1547470092773, 'accumulated_eval_time': 3452.14745926857, 'accumulated_logging_time': 41.74614763259888}
I0426 10:41:15.388684 139446942902016 logging_writer.py:48] [886] accumulated_eval_time=3452.147459, accumulated_logging_time=41.746148, accumulated_submission_time=1250.154747, global_step=886, preemption_count=0, score=1250.154747, test/loss=0.137957, test/num_examples=89274637, total_duration=4744.058102, train/loss=0.134449, validation/loss=0.134685, validation/num_examples=89000000
I0426 10:41:19.532657 139705133524800 checkpoints.py:356] Saving checkpoint at step: 886
I0426 10:41:42.570170 139705133524800 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_886
I0426 10:41:42.786432 139705133524800 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_886.
I0426 10:41:44.496906 139446934509312 logging_writer.py:48] [900] global_step=900, grad_norm=0.053550027310848236, loss=0.1346527338027954
I0426 10:43:44.977919 139446506710784 logging_writer.py:48] [1000] global_step=1000, grad_norm=0.028280576691031456, loss=0.1322874277830124
I0426 10:45:57.441834 139446934509312 logging_writer.py:48] [1100] global_step=1100, grad_norm=0.07770305126905441, loss=0.13495656847953796
I0426 10:48:08.940097 139446506710784 logging_writer.py:48] [1200] global_step=1200, grad_norm=0.15086381137371063, loss=0.13467104732990265
I0426 10:50:20.671489 139446934509312 logging_writer.py:48] [1300] global_step=1300, grad_norm=0.028478791937232018, loss=0.13148730993270874
I0426 10:50:44.052572 139705133524800 spec.py:298] Evaluating on the training split.
I0426 11:02:00.842435 139705133524800 spec.py:310] Evaluating on the validation split.
I0426 11:05:49.089560 139705133524800 spec.py:326] Evaluating on the test split.
I0426 11:10:23.992708 139705133524800 submission_runner.py:406] Time since start: 6492.67s, 	Step: 1319, 	{'train/loss': 0.13110330229387993, 'validation/loss': 0.13121206741573033, 'validation/num_examples': 89000000, 'test/loss': 0.13389305632236848, 'test/num_examples': 89274637, 'score': 1791.1999559402466, 'total_duration': 6492.671148061752, 'accumulated_submission_time': 1791.1999559402466, 'accumulated_eval_time': 4632.0875153541565, 'accumulated_logging_time': 69.36922192573547}
I0426 11:10:24.001467 139446464747264 logging_writer.py:48] [1319] accumulated_eval_time=4632.087515, accumulated_logging_time=69.369222, accumulated_submission_time=1791.199956, global_step=1319, preemption_count=0, score=1791.199956, test/loss=0.133893, test/num_examples=89274637, total_duration=6492.671148, train/loss=0.131103, validation/loss=0.131212, validation/num_examples=89000000
I0426 11:10:28.031932 139705133524800 checkpoints.py:356] Saving checkpoint at step: 1319
I0426 11:10:49.332841 139705133524800 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1319
I0426 11:10:49.540529 139705133524800 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1319.
I0426 11:12:07.455172 139446313809664 logging_writer.py:48] [1400] global_step=1400, grad_norm=0.008338550105690956, loss=0.13095812499523163
I0426 11:14:22.196206 139445852407552 logging_writer.py:48] [1500] global_step=1500, grad_norm=0.03808150067925453, loss=0.12998731434345245
I0426 11:16:33.898959 139705133524800 spec.py:298] Evaluating on the training split.
I0426 11:27:47.742055 139705133524800 spec.py:310] Evaluating on the validation split.
I0426 11:31:55.690762 139705133524800 spec.py:326] Evaluating on the test split.
I0426 11:36:22.881370 139705133524800 submission_runner.py:406] Time since start: 8051.56s, 	Step: 1600, 	{'train/loss': 0.12920772055653285, 'validation/loss': 0.13017132584269664, 'validation/num_examples': 89000000, 'test/loss': 0.13262883387585211, 'test/num_examples': 89274637, 'score': 2135.3606226444244, 'total_duration': 8051.559818744659, 'accumulated_submission_time': 2135.3606226444244, 'accumulated_eval_time': 5821.06987285614, 'accumulated_logging_time': 95.11174392700195}
I0426 11:36:22.889962 139436868212480 logging_writer.py:48] [1600] accumulated_eval_time=5821.069873, accumulated_logging_time=95.111744, accumulated_submission_time=2135.360623, global_step=1600, preemption_count=0, score=2135.360623, test/loss=0.132629, test/num_examples=89274637, total_duration=8051.559819, train/loss=0.129208, validation/loss=0.130171, validation/num_examples=89000000
I0426 11:36:26.977888 139705133524800 checkpoints.py:356] Saving checkpoint at step: 1600
I0426 11:36:49.474140 139705133524800 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600
I0426 11:36:49.672598 139705133524800 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600.
I0426 11:36:49.884610 139436717242112 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=2135.360623
I0426 11:36:53.673827 139705133524800 checkpoints.py:356] Saving checkpoint at step: 1600
I0426 11:37:23.372981 139705133524800 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600
I0426 11:37:23.593047 139705133524800 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nesterov/criteo1tb_jax/trial_1/checkpoint_1600.
I0426 11:39:10.457542 139705133524800 submission_runner.py:567] Tuning trial 1/1
I0426 11:39:10.459292 139705133524800 submission_runner.py:568] Hyperparameters: Hyperparameters(learning_rate=0.4394877561366806, one_minus_beta1=0.07113602458522507, warmup_factor=0.05, weight_decay=9.611851572925426e-07, label_smoothing=0.2, dropout_rate=0.0, decay_steps_factor=0.9, end_factor=0.001)
I0426 11:39:10.586795 139705133524800 submission_runner.py:569] Metrics: {'eval_results': [(1, {'train/loss': 1.574463070272259, 'validation/loss': 1.5822444943820224, 'validation/num_examples': 89000000, 'test/loss': 1.5753041258515563, 'test/num_examples': 89274637, 'score': 167.31317567825317, 'total_duration': 1328.0654611587524, 'accumulated_submission_time': 167.31317567825317, 'accumulated_eval_time': 1160.752079963684, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (450, {'train/loss': 0.13886464773687568, 'validation/loss': 0.13993039325842696, 'validation/num_examples': 89000000, 'test/loss': 0.14351891456024626, 'test/num_examples': 89274637, 'score': 708.403137922287, 'total_duration': 2986.4991025924683, 'accumulated_submission_time': 708.403137922287, 'accumulated_eval_time': 2263.269135951996, 'accumulated_logging_time': 14.821715593338013, 'global_step': 450, 'preemption_count': 0}), (886, {'train/loss': 0.13444898547803416, 'validation/loss': 0.13468531460674157, 'validation/num_examples': 89000000, 'test/loss': 0.13795685329977875, 'test/num_examples': 89274637, 'score': 1250.1547470092773, 'total_duration': 4744.05810213089, 'accumulated_submission_time': 1250.1547470092773, 'accumulated_eval_time': 3452.14745926857, 'accumulated_logging_time': 41.74614763259888, 'global_step': 886, 'preemption_count': 0}), (1319, {'train/loss': 0.13110330229387993, 'validation/loss': 0.13121206741573033, 'validation/num_examples': 89000000, 'test/loss': 0.13389305632236848, 'test/num_examples': 89274637, 'score': 1791.1999559402466, 'total_duration': 6492.671148061752, 'accumulated_submission_time': 1791.1999559402466, 'accumulated_eval_time': 4632.0875153541565, 'accumulated_logging_time': 69.36922192573547, 'global_step': 1319, 'preemption_count': 0}), (1600, {'train/loss': 0.12920772055653285, 'validation/loss': 0.13017132584269664, 'validation/num_examples': 89000000, 'test/loss': 0.13262883387585211, 'test/num_examples': 89274637, 'score': 2135.3606226444244, 'total_duration': 8051.559818744659, 'accumulated_submission_time': 2135.3606226444244, 'accumulated_eval_time': 5821.06987285614, 'accumulated_logging_time': 95.11174392700195, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0426 11:39:10.587035 139705133524800 submission_runner.py:570] Timing: 2135.3606226444244
I0426 11:39:10.587103 139705133524800 submission_runner.py:571] ====================
I0426 11:39:10.587232 139705133524800 submission_runner.py:631] Final criteo1tb score: 2135.3606226444244
