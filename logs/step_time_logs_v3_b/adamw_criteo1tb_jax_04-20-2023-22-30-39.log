I0420 22:30:59.255920 139976606947136 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax.
I0420 22:30:59.391996 139976606947136 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0420 22:31:00.211079 139976606947136 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: CUDA Host Interpreter
I0420 22:31:00.211807 139976606947136 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0420 22:31:00.216161 139976606947136 submission_runner.py:528] Using RNG seed 1919728473
I0420 22:31:02.913047 139976606947136 submission_runner.py:537] --- Tuning run 1/1 ---
I0420 22:31:02.913286 139976606947136 submission_runner.py:542] Creating tuning directory at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1.
I0420 22:31:02.913498 139976606947136 logger_utils.py:83] Saving hparams to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/hparams.json.
I0420 22:31:03.037903 139976606947136 submission_runner.py:232] Initializing dataset.
I0420 22:31:03.038165 139976606947136 submission_runner.py:239] Initializing model.
I0420 22:31:09.537288 139976606947136 submission_runner.py:249] Initializing optimizer.
I0420 22:31:12.351524 139976606947136 submission_runner.py:256] Initializing metrics bundle.
I0420 22:31:12.351819 139976606947136 submission_runner.py:273] Initializing checkpoint and logger.
I0420 22:31:12.355813 139976606947136 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1 with prefix checkpoint_
I0420 22:31:12.356158 139976606947136 logger_utils.py:230] Unable to record workload.train_mean information. Continuing without it.
I0420 22:31:12.356226 139976606947136 logger_utils.py:230] Unable to record workload.train_stddev information. Continuing without it.
I0420 22:31:13.228073 139976606947136 submission_runner.py:294] Saving meta data to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/meta_data_0.json.
I0420 22:31:13.231193 139976606947136 submission_runner.py:297] Saving flags to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/flags_0.json.
I0420 22:31:13.280467 139976606947136 submission_runner.py:309] Starting training loop.
I0420 22:34:02.014590 139770324829952 logging_writer.py:48] [0] global_step=0, grad_norm=3.1536266803741455, loss=0.39479973912239075
I0420 22:34:02.028570 139976606947136 spec.py:298] Evaluating on the training split.
I0420 22:43:14.793610 139976606947136 spec.py:310] Evaluating on the validation split.
I0420 22:47:24.719060 139976606947136 spec.py:326] Evaluating on the test split.
I0420 22:51:56.010956 139976606947136 submission_runner.py:406] Time since start: 1242.73s, 	Step: 1, 	{'train/loss': 0.39513351743584435, 'validation/loss': 0.39988283146067416, 'validation/num_examples': 89000000, 'test/loss': 0.39753678303950984, 'test/num_examples': 89274637, 'score': 168.74784064292908, 'total_duration': 1242.7303874492645, 'accumulated_submission_time': 168.74784064292908, 'accumulated_eval_time': 1073.9823095798492, 'accumulated_logging_time': 0}
I0420 22:51:56.029125 139715764258560 logging_writer.py:48] [1] accumulated_eval_time=1073.982310, accumulated_logging_time=0, accumulated_submission_time=168.747841, global_step=1, preemption_count=0, score=168.747841, test/loss=0.397537, test/num_examples=89274637, total_duration=1242.730387, train/loss=0.395134, validation/loss=0.399883, validation/num_examples=89000000
I0420 22:51:58.421237 139976606947136 checkpoints.py:356] Saving checkpoint at step: 1
I0420 22:52:14.068654 139976606947136 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1
I0420 22:52:14.080613 139976606947136 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1.
I0420 22:53:36.521938 139715755865856 logging_writer.py:48] [100] global_step=100, grad_norm=0.018874268978834152, loss=0.12943732738494873
I0420 22:55:28.440439 139715722295040 logging_writer.py:48] [200] global_step=200, grad_norm=0.0219015721231699, loss=0.1285381317138672
I0420 22:57:22.203367 139715755865856 logging_writer.py:48] [300] global_step=300, grad_norm=0.09613461792469025, loss=0.12688323855400085
I0420 22:59:34.307286 139715722295040 logging_writer.py:48] [400] global_step=400, grad_norm=0.06960774213075638, loss=0.1252104490995407
I0420 23:01:14.196773 139976606947136 spec.py:298] Evaluating on the training split.
I0420 23:10:57.723303 139976606947136 spec.py:310] Evaluating on the validation split.
I0420 23:14:11.627085 139976606947136 spec.py:326] Evaluating on the test split.
I0420 23:17:42.735316 139976606947136 submission_runner.py:406] Time since start: 2789.45s, 	Step: 488, 	{'train/loss': 0.12731250934165747, 'validation/loss': 0.1279610449438202, 'validation/num_examples': 89000000, 'test/loss': 0.13018868953788074, 'test/num_examples': 89274637, 'score': 708.8471093177795, 'total_duration': 2789.45476436615, 'accumulated_submission_time': 708.8471093177795, 'accumulated_eval_time': 2062.520809173584, 'accumulated_logging_time': 18.081467390060425}
I0420 23:17:42.744984 139757011052288 logging_writer.py:48] [488] accumulated_eval_time=2062.520809, accumulated_logging_time=18.081467, accumulated_submission_time=708.847109, global_step=488, preemption_count=0, score=708.847109, test/loss=0.130189, test/num_examples=89274637, total_duration=2789.454764, train/loss=0.127313, validation/loss=0.127961, validation/num_examples=89000000
I0420 23:17:50.116819 139976606947136 checkpoints.py:356] Saving checkpoint at step: 488
I0420 23:18:30.107277 139976606947136 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_488
I0420 23:18:30.370115 139976606947136 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_488.
I0420 23:18:32.117206 139753133733632 logging_writer.py:48] [500] global_step=500, grad_norm=0.0070043932646512985, loss=0.12635627388954163
I0420 23:20:07.582864 139752992925440 logging_writer.py:48] [600] global_step=600, grad_norm=0.1522909253835678, loss=0.1285286694765091
I0420 23:21:55.679834 139753133733632 logging_writer.py:48] [700] global_step=700, grad_norm=0.0400884635746479, loss=0.12577171623706818
I0420 23:23:46.114986 139752992925440 logging_writer.py:48] [800] global_step=800, grad_norm=0.05187217891216278, loss=0.12498530745506287
I0420 23:25:38.852809 139753133733632 logging_writer.py:48] [900] global_step=900, grad_norm=0.019045831635594368, loss=0.12504015862941742
I0420 23:27:30.890589 139976606947136 spec.py:298] Evaluating on the training split.
I0420 23:37:22.013081 139976606947136 spec.py:310] Evaluating on the validation split.
I0420 23:41:05.833659 139976606947136 spec.py:326] Evaluating on the test split.
I0420 23:45:51.038351 139976606947136 submission_runner.py:406] Time since start: 4477.76s, 	Step: 994, 	{'train/loss': 0.1246484752259244, 'validation/loss': 0.1257822584269663, 'validation/num_examples': 89000000, 'test/loss': 0.1281472250623657, 'test/num_examples': 89274637, 'score': 1249.0336275100708, 'total_duration': 4477.757538795471, 'accumulated_submission_time': 1249.0336275100708, 'accumulated_eval_time': 3162.6682574748993, 'accumulated_logging_time': 66.0447051525116}
I0420 23:45:51.048667 139707837052672 logging_writer.py:48] [994] accumulated_eval_time=3162.668257, accumulated_logging_time=66.044705, accumulated_submission_time=1249.033628, global_step=994, preemption_count=0, score=1249.033628, test/loss=0.128147, test/num_examples=89274637, total_duration=4477.757539, train/loss=0.124648, validation/loss=0.125782, validation/num_examples=89000000
I0420 23:45:56.341595 139976606947136 checkpoints.py:356] Saving checkpoint at step: 994
I0420 23:46:24.692368 139976606947136 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_994
I0420 23:46:24.917067 139976606947136 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_994.
I0420 23:46:25.983407 139707828659968 logging_writer.py:48] [1000] global_step=1000, grad_norm=0.008218958042562008, loss=0.12569937109947205
I0420 23:47:54.835208 139707501508352 logging_writer.py:48] [1100] global_step=1100, grad_norm=0.005490145180374384, loss=0.12536245584487915
I0420 23:49:42.169578 139707828659968 logging_writer.py:48] [1200] global_step=1200, grad_norm=0.007158038672059774, loss=0.12493699789047241
I0420 23:51:32.456192 139707501508352 logging_writer.py:48] [1300] global_step=1300, grad_norm=0.011863740161061287, loss=0.1243680939078331
I0420 23:53:47.430680 139707828659968 logging_writer.py:48] [1400] global_step=1400, grad_norm=0.022664260119199753, loss=0.12358643114566803
I0420 23:55:25.882842 139976606947136 spec.py:298] Evaluating on the training split.
I0421 00:05:14.052156 139976606947136 spec.py:310] Evaluating on the validation split.
I0421 00:09:15.014624 139976606947136 spec.py:326] Evaluating on the test split.
I0421 00:13:19.498749 139976606947136 submission_runner.py:406] Time since start: 6126.22s, 	Step: 1481, 	{'train/loss': 0.1244632364459736, 'validation/loss': 0.12532503370786516, 'validation/num_examples': 89000000, 'test/loss': 0.12762147663507162, 'test/num_examples': 89274637, 'score': 1789.704226732254, 'total_duration': 6126.2182331085205, 'accumulated_submission_time': 1789.704226732254, 'accumulated_eval_time': 4236.284139156342, 'accumulated_logging_time': 100.21339726448059}
I0421 00:13:19.506601 139707501508352 logging_writer.py:48] [1481] accumulated_eval_time=4236.284139, accumulated_logging_time=100.213397, accumulated_submission_time=1789.704227, global_step=1481, preemption_count=0, score=1789.704227, test/loss=0.127621, test/num_examples=89274637, total_duration=6126.218233, train/loss=0.124463, validation/loss=0.125325, validation/num_examples=89000000
I0421 00:13:24.845486 139976606947136 checkpoints.py:356] Saving checkpoint at step: 1481
I0421 00:13:54.185286 139976606947136 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1481
I0421 00:13:54.441220 139976606947136 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1481.
I0421 00:13:56.868756 139707828659968 logging_writer.py:48] [1500] global_step=1500, grad_norm=0.027687232941389084, loss=0.12392056733369827
I0421 00:16:30.100088 139976606947136 spec.py:298] Evaluating on the training split.
I0421 00:25:58.691001 139976606947136 spec.py:310] Evaluating on the validation split.
I0421 00:30:22.846614 139976606947136 spec.py:326] Evaluating on the test split.
I0421 00:34:30.051827 139976606947136 submission_runner.py:406] Time since start: 7396.77s, 	Step: 1600, 	{'train/loss': 0.12442932802583472, 'validation/loss': 0.12532970786516853, 'validation/num_examples': 89000000, 'test/loss': 0.12767564655569533, 'test/num_examples': 89274637, 'score': 1945.0922429561615, 'total_duration': 7396.771287918091, 'accumulated_submission_time': 1945.0922429561615, 'accumulated_eval_time': 5316.235816717148, 'accumulated_logging_time': 135.4254014492035}
I0421 00:34:30.059652 139752263120640 logging_writer.py:48] [1600] accumulated_eval_time=5316.235817, accumulated_logging_time=135.425401, accumulated_submission_time=1945.092243, global_step=1600, preemption_count=0, score=1945.092243, test/loss=0.127676, test/num_examples=89274637, total_duration=7396.771288, train/loss=0.124429, validation/loss=0.125330, validation/num_examples=89000000
I0421 00:34:35.045092 139976606947136 checkpoints.py:356] Saving checkpoint at step: 1600
I0421 00:35:05.528630 139976606947136 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600
I0421 00:35:05.822849 139976606947136 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0421 00:35:06.091686 139707828659968 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=1945.092243
I0421 00:35:10.915877 139976606947136 checkpoints.py:356] Saving checkpoint at step: 1600
I0421 00:35:48.183574 139976606947136 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600
I0421 00:35:48.484175 139976606947136 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0421 00:37:10.688409 139976606947136 submission_runner.py:567] Tuning trial 1/1
I0421 00:37:10.689696 139976606947136 submission_runner.py:568] Hyperparameters: Hyperparameters(learning_rate=0.0019814680146414726, one_minus_beta1=0.22838767981804783, beta2=0.999, warmup_factor=0.05, weight_decay=0.010340635370188849, label_smoothing=0.1, dropout_rate=0.0)
I0421 00:37:10.690140 139976606947136 submission_runner.py:569] Metrics: {'eval_results': [(1, {'train/loss': 0.39513351743584435, 'validation/loss': 0.39988283146067416, 'validation/num_examples': 89000000, 'test/loss': 0.39753678303950984, 'test/num_examples': 89274637, 'score': 168.74784064292908, 'total_duration': 1242.7303874492645, 'accumulated_submission_time': 168.74784064292908, 'accumulated_eval_time': 1073.9823095798492, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (488, {'train/loss': 0.12731250934165747, 'validation/loss': 0.1279610449438202, 'validation/num_examples': 89000000, 'test/loss': 0.13018868953788074, 'test/num_examples': 89274637, 'score': 708.8471093177795, 'total_duration': 2789.45476436615, 'accumulated_submission_time': 708.8471093177795, 'accumulated_eval_time': 2062.520809173584, 'accumulated_logging_time': 18.081467390060425, 'global_step': 488, 'preemption_count': 0}), (994, {'train/loss': 0.1246484752259244, 'validation/loss': 0.1257822584269663, 'validation/num_examples': 89000000, 'test/loss': 0.1281472250623657, 'test/num_examples': 89274637, 'score': 1249.0336275100708, 'total_duration': 4477.757538795471, 'accumulated_submission_time': 1249.0336275100708, 'accumulated_eval_time': 3162.6682574748993, 'accumulated_logging_time': 66.0447051525116, 'global_step': 994, 'preemption_count': 0}), (1481, {'train/loss': 0.1244632364459736, 'validation/loss': 0.12532503370786516, 'validation/num_examples': 89000000, 'test/loss': 0.12762147663507162, 'test/num_examples': 89274637, 'score': 1789.704226732254, 'total_duration': 6126.2182331085205, 'accumulated_submission_time': 1789.704226732254, 'accumulated_eval_time': 4236.284139156342, 'accumulated_logging_time': 100.21339726448059, 'global_step': 1481, 'preemption_count': 0}), (1600, {'train/loss': 0.12442932802583472, 'validation/loss': 0.12532970786516853, 'validation/num_examples': 89000000, 'test/loss': 0.12767564655569533, 'test/num_examples': 89274637, 'score': 1945.0922429561615, 'total_duration': 7396.771287918091, 'accumulated_submission_time': 1945.0922429561615, 'accumulated_eval_time': 5316.235816717148, 'accumulated_logging_time': 135.4254014492035, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0421 00:37:10.690221 139976606947136 submission_runner.py:570] Timing: 1945.0922429561615
I0421 00:37:10.690267 139976606947136 submission_runner.py:571] ====================
I0421 00:37:10.690365 139976606947136 submission_runner.py:631] Final criteo1tb score: 1945.0922429561615
