I0420 21:58:39.996159 139901855545152 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax.
I0420 21:58:40.150559 139901855545152 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0420 21:58:41.005504 139901855545152 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Host Interpreter CUDA
I0420 21:58:41.006289 139901855545152 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0420 21:58:41.010024 139901855545152 submission_runner.py:528] Using RNG seed 4012812428
I0420 21:58:43.609502 139901855545152 submission_runner.py:537] --- Tuning run 1/1 ---
I0420 21:58:43.609740 139901855545152 submission_runner.py:542] Creating tuning directory at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1.
I0420 21:58:43.609994 139901855545152 logger_utils.py:83] Saving hparams to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/hparams.json.
I0420 21:58:43.732851 139901855545152 submission_runner.py:232] Initializing dataset.
I0420 21:58:43.733062 139901855545152 submission_runner.py:239] Initializing model.
I0420 21:58:49.688822 139901855545152 submission_runner.py:249] Initializing optimizer.
I0420 21:58:52.583895 139901855545152 submission_runner.py:256] Initializing metrics bundle.
I0420 21:58:52.584113 139901855545152 submission_runner.py:273] Initializing checkpoint and logger.
I0420 21:58:52.588516 139901855545152 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1 with prefix checkpoint_
I0420 21:58:52.588831 139901855545152 logger_utils.py:230] Unable to record workload.train_mean information. Continuing without it.
I0420 21:58:52.588894 139901855545152 logger_utils.py:230] Unable to record workload.train_stddev information. Continuing without it.
I0420 21:58:53.373922 139901855545152 submission_runner.py:294] Saving meta data to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/meta_data_0.json.
I0420 21:58:53.374854 139901855545152 submission_runner.py:297] Saving flags to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/flags_0.json.
I0420 21:58:53.426766 139901855545152 submission_runner.py:309] Starting training loop.
I0420 22:01:40.206630 139695649449728 logging_writer.py:48] [0] global_step=0, grad_norm=9.036208152770996, loss=0.9835746884346008
I0420 22:01:40.234543 139901855545152 spec.py:298] Evaluating on the training split.
I0420 22:10:49.699448 139901855545152 spec.py:310] Evaluating on the validation split.
I0420 22:15:07.480916 139901855545152 spec.py:326] Evaluating on the test split.
I0420 22:19:48.455085 139901855545152 submission_runner.py:406] Time since start: 1255.03s, 	Step: 1, 	{'train/loss': 0.9844826087081494, 'validation/loss': 0.9767169438202247, 'validation/num_examples': 89000000, 'test/loss': 0.9800422935351728, 'test/num_examples': 89274637, 'score': 166.80756616592407, 'total_duration': 1255.0282349586487, 'accumulated_submission_time': 166.80756616592407, 'accumulated_eval_time': 1088.2204711437225, 'accumulated_logging_time': 0}
I0420 22:19:48.472695 139639535965952 logging_writer.py:48] [1] accumulated_eval_time=1088.220471, accumulated_logging_time=0, accumulated_submission_time=166.807566, global_step=1, preemption_count=0, score=166.807566, test/loss=0.980042, test/num_examples=89274637, total_duration=1255.028235, train/loss=0.984483, validation/loss=0.976717, validation/num_examples=89000000
I0420 22:19:51.396717 139901855545152 checkpoints.py:356] Saving checkpoint at step: 1
I0420 22:20:09.623773 139901855545152 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1
I0420 22:20:09.639029 139901855545152 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1.
I0420 22:21:35.117680 139639386011392 logging_writer.py:48] [100] global_step=100, grad_norm=0.04577052593231201, loss=0.13487744331359863
I0420 22:23:30.718847 139639352440576 logging_writer.py:48] [200] global_step=200, grad_norm=0.006765028461813927, loss=0.12811048328876495
I0420 22:25:28.966751 139639386011392 logging_writer.py:48] [300] global_step=300, grad_norm=0.08660827577114105, loss=0.12752091884613037
I0420 22:27:27.222061 139639352440576 logging_writer.py:48] [400] global_step=400, grad_norm=0.029864873737096786, loss=0.12769374251365662
I0420 22:29:10.483873 139901855545152 spec.py:298] Evaluating on the training split.
I0420 22:39:24.827118 139901855545152 spec.py:310] Evaluating on the validation split.
I0420 22:43:03.283596 139901855545152 spec.py:326] Evaluating on the test split.
I0420 22:47:10.186202 139901855545152 submission_runner.py:406] Time since start: 2896.76s, 	Step: 489, 	{'train/loss': 0.1253335712761279, 'validation/loss': 0.12669560674157304, 'validation/num_examples': 89000000, 'test/loss': 0.12907431928286642, 'test/num_examples': 89274637, 'score': 707.6324553489685, 'total_duration': 2896.759349346161, 'accumulated_submission_time': 707.6324553489685, 'accumulated_eval_time': 2167.922742128372, 'accumulated_logging_time': 21.198793172836304}
I0420 22:47:10.194621 139639335655168 logging_writer.py:48] [489] accumulated_eval_time=2167.922742, accumulated_logging_time=21.198793, accumulated_submission_time=707.632455, global_step=489, preemption_count=0, score=707.632455, test/loss=0.129074, test/num_examples=89274637, total_duration=2896.759349, train/loss=0.125334, validation/loss=0.126696, validation/num_examples=89000000
I0420 22:47:15.983213 139901855545152 checkpoints.py:356] Saving checkpoint at step: 489
I0420 22:47:47.549840 139901855545152 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_489
I0420 22:47:47.788101 139901855545152 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_489.
I0420 22:47:49.390810 139639327262464 logging_writer.py:48] [500] global_step=500, grad_norm=0.058508116751909256, loss=0.12557655572891235
I0420 22:49:30.737160 139639285298944 logging_writer.py:48] [600] global_step=600, grad_norm=0.08637329936027527, loss=0.12862613797187805
I0420 22:51:27.664493 139639327262464 logging_writer.py:48] [700] global_step=700, grad_norm=0.049871671944856644, loss=0.12515945732593536
I0420 22:53:24.166666 139639285298944 logging_writer.py:48] [800] global_step=800, grad_norm=0.03141072019934654, loss=0.1263241171836853
I0420 22:55:19.479770 139639327262464 logging_writer.py:48] [900] global_step=900, grad_norm=0.01118626818060875, loss=0.12767496705055237
I0420 22:56:48.300728 139901855545152 spec.py:298] Evaluating on the training split.
I0420 23:06:51.027667 139901855545152 spec.py:310] Evaluating on the validation split.
I0420 23:10:55.244647 139901855545152 spec.py:326] Evaluating on the test split.
I0420 23:15:34.993078 139901855545152 submission_runner.py:406] Time since start: 4601.57s, 	Step: 977, 	{'train/loss': 0.1241730275269902, 'validation/loss': 0.12570194382022473, 'validation/num_examples': 89000000, 'test/loss': 0.1280253987479109, 'test/num_examples': 89274637, 'score': 1247.8451302051544, 'total_duration': 4601.566015481949, 'accumulated_submission_time': 1247.8451302051544, 'accumulated_eval_time': 3294.6148188114166, 'accumulated_logging_time': 59.0955491065979}
I0420 23:15:35.003406 139631400056576 logging_writer.py:48] [977] accumulated_eval_time=3294.614819, accumulated_logging_time=59.095549, accumulated_submission_time=1247.845130, global_step=977, preemption_count=0, score=1247.845130, test/loss=0.128025, test/num_examples=89274637, total_duration=4601.566015, train/loss=0.124173, validation/loss=0.125702, validation/num_examples=89000000
I0420 23:15:40.632883 139901855545152 checkpoints.py:356] Saving checkpoint at step: 977
I0420 23:16:10.771196 139901855545152 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_977
I0420 23:16:10.985374 139901855545152 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_977.
I0420 23:16:13.858834 139631391663872 logging_writer.py:48] [1000] global_step=1000, grad_norm=0.006724464241415262, loss=0.12480169534683228
I0420 23:18:06.488328 139631265838848 logging_writer.py:48] [1100] global_step=1100, grad_norm=0.01381363719701767, loss=0.12640072405338287
I0420 23:20:02.191419 139631391663872 logging_writer.py:48] [1200] global_step=1200, grad_norm=0.017032019793987274, loss=0.12591776251792908
I0420 23:21:57.182988 139631265838848 logging_writer.py:48] [1300] global_step=1300, grad_norm=0.012103406712412834, loss=0.1251501441001892
I0420 23:23:52.594848 139631391663872 logging_writer.py:48] [1400] global_step=1400, grad_norm=0.01465324591845274, loss=0.12823322415351868
I0420 23:25:11.792699 139901855545152 spec.py:298] Evaluating on the training split.
I0420 23:34:56.666412 139901855545152 spec.py:310] Evaluating on the validation split.
I0420 23:39:16.394096 139901855545152 spec.py:326] Evaluating on the test split.
I0420 23:43:39.365144 139901855545152 submission_runner.py:406] Time since start: 6285.94s, 	Step: 1470, 	{'train/loss': 0.12400714573919817, 'validation/loss': 0.12527698876404494, 'validation/num_examples': 89000000, 'test/loss': 0.1275542682968288, 'test/num_examples': 89274637, 'score': 1788.3634932041168, 'total_duration': 6285.938312292099, 'accumulated_submission_time': 1788.3634932041168, 'accumulated_eval_time': 4402.187233924866, 'accumulated_logging_time': 95.37146234512329}
I0420 23:43:39.373090 139631265838848 logging_writer.py:48] [1470] accumulated_eval_time=4402.187234, accumulated_logging_time=95.371462, accumulated_submission_time=1788.363493, global_step=1470, preemption_count=0, score=1788.363493, test/loss=0.127554, test/num_examples=89274637, total_duration=6285.938312, train/loss=0.124007, validation/loss=0.125277, validation/num_examples=89000000
I0420 23:43:44.992938 139901855545152 checkpoints.py:356] Saving checkpoint at step: 1470
I0420 23:44:17.125419 139901855545152 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1470
I0420 23:44:17.344960 139901855545152 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1470.
I0420 23:44:24.769710 139631391663872 logging_writer.py:48] [1500] global_step=1500, grad_norm=0.006538103334605694, loss=0.12617047131061554
I0420 23:46:18.845173 139901855545152 spec.py:298] Evaluating on the training split.
I0420 23:56:10.456638 139901855545152 spec.py:310] Evaluating on the validation split.
I0421 00:00:30.406528 139901855545152 spec.py:326] Evaluating on the test split.
I0421 00:05:10.615243 139901855545152 submission_runner.py:406] Time since start: 7577.19s, 	Step: 1600, 	{'train/loss': 0.12426215502336851, 'validation/loss': 0.12510320224719101, 'validation/num_examples': 89000000, 'test/loss': 0.12740710443885647, 'test/num_examples': 89274637, 'score': 1909.6005182266235, 'total_duration': 7577.188336849213, 'accumulated_submission_time': 1909.6005182266235, 'accumulated_eval_time': 5533.957192659378, 'accumulated_logging_time': 133.61299300193787}
I0421 00:05:10.623219 139642179340032 logging_writer.py:48] [1600] accumulated_eval_time=5533.957193, accumulated_logging_time=133.612993, accumulated_submission_time=1909.600518, global_step=1600, preemption_count=0, score=1909.600518, test/loss=0.127407, test/num_examples=89274637, total_duration=7577.188337, train/loss=0.124262, validation/loss=0.125103, validation/num_examples=89000000
I0421 00:05:16.144385 139901855545152 checkpoints.py:356] Saving checkpoint at step: 1600
I0421 00:05:49.314332 139901855545152 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600
I0421 00:05:49.635893 139901855545152 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0421 00:05:49.945306 139631391663872 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=1909.600518
I0421 00:05:55.282011 139901855545152 checkpoints.py:356] Saving checkpoint at step: 1600
I0421 00:06:35.598102 139901855545152 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600
I0421 00:06:35.899480 139901855545152 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0421 00:08:06.187431 139901855545152 submission_runner.py:567] Tuning trial 1/1
I0421 00:08:06.188312 139901855545152 submission_runner.py:568] Hyperparameters: Hyperparameters(learning_rate=0.0019814680146414726, one_minus_beta1=0.045677535963609565, beta2=0.999, warmup_factor=0.05, weight_decay=0.010340635370188849, label_smoothing=0.1, dropout_rate=0.0)
I0421 00:08:06.195594 139901855545152 submission_runner.py:569] Metrics: {'eval_results': [(1, {'train/loss': 0.9844826087081494, 'validation/loss': 0.9767169438202247, 'validation/num_examples': 89000000, 'test/loss': 0.9800422935351728, 'test/num_examples': 89274637, 'score': 166.80756616592407, 'total_duration': 1255.0282349586487, 'accumulated_submission_time': 166.80756616592407, 'accumulated_eval_time': 1088.2204711437225, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (489, {'train/loss': 0.1253335712761279, 'validation/loss': 0.12669560674157304, 'validation/num_examples': 89000000, 'test/loss': 0.12907431928286642, 'test/num_examples': 89274637, 'score': 707.6324553489685, 'total_duration': 2896.759349346161, 'accumulated_submission_time': 707.6324553489685, 'accumulated_eval_time': 2167.922742128372, 'accumulated_logging_time': 21.198793172836304, 'global_step': 489, 'preemption_count': 0}), (977, {'train/loss': 0.1241730275269902, 'validation/loss': 0.12570194382022473, 'validation/num_examples': 89000000, 'test/loss': 0.1280253987479109, 'test/num_examples': 89274637, 'score': 1247.8451302051544, 'total_duration': 4601.566015481949, 'accumulated_submission_time': 1247.8451302051544, 'accumulated_eval_time': 3294.6148188114166, 'accumulated_logging_time': 59.0955491065979, 'global_step': 977, 'preemption_count': 0}), (1470, {'train/loss': 0.12400714573919817, 'validation/loss': 0.12527698876404494, 'validation/num_examples': 89000000, 'test/loss': 0.1275542682968288, 'test/num_examples': 89274637, 'score': 1788.3634932041168, 'total_duration': 6285.938312292099, 'accumulated_submission_time': 1788.3634932041168, 'accumulated_eval_time': 4402.187233924866, 'accumulated_logging_time': 95.37146234512329, 'global_step': 1470, 'preemption_count': 0}), (1600, {'train/loss': 0.12426215502336851, 'validation/loss': 0.12510320224719101, 'validation/num_examples': 89000000, 'test/loss': 0.12740710443885647, 'test/num_examples': 89274637, 'score': 1909.6005182266235, 'total_duration': 7577.188336849213, 'accumulated_submission_time': 1909.6005182266235, 'accumulated_eval_time': 5533.957192659378, 'accumulated_logging_time': 133.61299300193787, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0421 00:08:06.195729 139901855545152 submission_runner.py:570] Timing: 1909.6005182266235
I0421 00:08:06.195779 139901855545152 submission_runner.py:571] ====================
I0421 00:08:06.195872 139901855545152 submission_runner.py:631] Final criteo1tb score: 1909.6005182266235
