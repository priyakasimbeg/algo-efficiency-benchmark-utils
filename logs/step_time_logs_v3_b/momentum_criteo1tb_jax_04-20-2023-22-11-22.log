I0420 22:11:42.455099 139749654058816 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax.
I0420 22:11:42.598211 139749654058816 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0420 22:11:43.496099 139749654058816 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: CUDA Interpreter Host
I0420 22:11:43.496959 139749654058816 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0420 22:11:43.501786 139749654058816 submission_runner.py:528] Using RNG seed 308132976
I0420 22:11:46.300347 139749654058816 submission_runner.py:537] --- Tuning run 1/1 ---
I0420 22:11:46.300611 139749654058816 submission_runner.py:542] Creating tuning directory at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1.
I0420 22:11:46.300826 139749654058816 logger_utils.py:83] Saving hparams to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/hparams.json.
I0420 22:11:46.428354 139749654058816 submission_runner.py:232] Initializing dataset.
I0420 22:11:46.428636 139749654058816 submission_runner.py:239] Initializing model.
I0420 22:11:52.976413 139749654058816 submission_runner.py:249] Initializing optimizer.
I0420 22:11:54.573326 139749654058816 submission_runner.py:256] Initializing metrics bundle.
I0420 22:11:54.573621 139749654058816 submission_runner.py:273] Initializing checkpoint and logger.
I0420 22:11:54.577937 139749654058816 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1 with prefix checkpoint_
I0420 22:11:54.578326 139749654058816 logger_utils.py:230] Unable to record workload.train_mean information. Continuing without it.
I0420 22:11:54.578400 139749654058816 logger_utils.py:230] Unable to record workload.train_stddev information. Continuing without it.
I0420 22:11:55.434950 139749654058816 submission_runner.py:294] Saving meta data to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/meta_data_0.json.
I0420 22:11:55.436058 139749654058816 submission_runner.py:297] Saving flags to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/flags_0.json.
I0420 22:11:55.492893 139749654058816 submission_runner.py:309] Starting training loop.
I0420 22:14:41.476108 139544192087808 logging_writer.py:48] [0] global_step=0, grad_norm=10.170477867126465, loss=3.284787893295288
I0420 22:14:41.486359 139749654058816 spec.py:298] Evaluating on the training split.
I0420 22:23:32.922427 139749654058816 spec.py:310] Evaluating on the validation split.
I0420 22:27:38.401421 139749654058816 spec.py:326] Evaluating on the test split.
I0420 22:31:59.589035 139749654058816 submission_runner.py:406] Time since start: 1204.10s, 	Step: 1, 	{'train/loss': 3.284140524397535, 'validation/loss': 3.285534202247191, 'validation/num_examples': 89000000, 'test/loss': 3.2832699840605346, 'test/num_examples': 89274637, 'score': 165.99319291114807, 'total_duration': 1204.0960838794708, 'accumulated_submission_time': 165.99319291114807, 'accumulated_eval_time': 1038.1025958061218, 'accumulated_logging_time': 0}
I0420 22:31:59.605011 139488130991872 logging_writer.py:48] [1] accumulated_eval_time=1038.102596, accumulated_logging_time=0, accumulated_submission_time=165.993193, global_step=1, preemption_count=0, score=165.993193, test/loss=3.283270, test/num_examples=89274637, total_duration=1204.096084, train/loss=3.284141, validation/loss=3.285534, validation/num_examples=89000000
I0420 22:32:01.226427 139749654058816 checkpoints.py:356] Saving checkpoint at step: 1
I0420 22:32:11.777031 139749654058816 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1
I0420 22:32:11.785411 139749654058816 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1.
I0420 22:33:38.284396 139488122599168 logging_writer.py:48] [100] global_step=100, grad_norm=0.062246084213256836, loss=0.13809771835803986
I0420 22:35:58.820988 139488089028352 logging_writer.py:48] [200] global_step=200, grad_norm=0.030832672491669655, loss=0.1369490921497345
I0420 22:37:48.070864 139488122599168 logging_writer.py:48] [300] global_step=300, grad_norm=0.032372768968343735, loss=0.1373528093099594
I0420 22:39:38.465084 139488089028352 logging_writer.py:48] [400] global_step=400, grad_norm=0.021878836676478386, loss=0.13439813256263733
I0420 22:41:12.310956 139749654058816 spec.py:298] Evaluating on the training split.
I0420 22:50:44.064145 139749654058816 spec.py:310] Evaluating on the validation split.
I0420 22:54:09.476495 139749654058816 spec.py:326] Evaluating on the test split.
I0420 22:58:13.331472 139749654058816 submission_runner.py:406] Time since start: 2777.84s, 	Step: 487, 	{'train/loss': 0.13551573090205918, 'validation/loss': 0.13605140449438202, 'validation/num_examples': 89000000, 'test/loss': 0.13915681337354527, 'test/num_examples': 89274637, 'score': 706.5057873725891, 'total_duration': 2777.838493824005, 'accumulated_submission_time': 706.5057873725891, 'accumulated_eval_time': 2059.1230585575104, 'accumulated_logging_time': 12.20443606376648}
I0420 22:58:13.339543 139483299153664 logging_writer.py:48] [487] accumulated_eval_time=2059.123059, accumulated_logging_time=12.204436, accumulated_submission_time=706.505787, global_step=487, preemption_count=0, score=706.505787, test/loss=0.139157, test/num_examples=89274637, total_duration=2777.838494, train/loss=0.135516, validation/loss=0.136051, validation/num_examples=89000000
I0420 22:58:16.886454 139749654058816 checkpoints.py:356] Saving checkpoint at step: 487
I0420 22:58:36.411179 139749654058816 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_487
I0420 22:58:36.584984 139749654058816 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_487.
I0420 22:58:38.159220 139483290760960 logging_writer.py:48] [500] global_step=500, grad_norm=0.02115124650299549, loss=0.13565023243427277
I0420 23:00:19.508303 139483248797440 logging_writer.py:48] [600] global_step=600, grad_norm=0.023187631741166115, loss=0.1322072297334671
I0420 23:02:49.367938 139483290760960 logging_writer.py:48] [700] global_step=700, grad_norm=0.01338735781610012, loss=0.13339295983314514
I0420 23:04:55.597956 139483248797440 logging_writer.py:48] [800] global_step=800, grad_norm=0.186520054936409, loss=0.1374269723892212
I0420 23:06:44.722794 139483290760960 logging_writer.py:48] [900] global_step=900, grad_norm=0.017964590340852737, loss=0.13100358843803406
I0420 23:07:37.609159 139749654058816 spec.py:298] Evaluating on the training split.
I0420 23:17:31.960844 139749654058816 spec.py:310] Evaluating on the validation split.
I0420 23:21:29.415060 139749654058816 spec.py:326] Evaluating on the test split.
I0420 23:25:30.917866 139749654058816 submission_runner.py:406] Time since start: 4415.42s, 	Step: 951, 	{'train/loss': 0.13162886035012533, 'validation/loss': 0.13156655056179775, 'validation/num_examples': 89000000, 'test/loss': 0.13440093853307966, 'test/num_examples': 89274637, 'score': 1247.3382697105408, 'total_duration': 4415.424575805664, 'accumulated_submission_time': 1247.3382697105408, 'accumulated_eval_time': 3132.4313611984253, 'accumulated_logging_time': 35.6445996761322}
I0420 23:25:30.928036 139483248797440 logging_writer.py:48] [951] accumulated_eval_time=3132.431361, accumulated_logging_time=35.644600, accumulated_submission_time=1247.338270, global_step=951, preemption_count=0, score=1247.338270, test/loss=0.134401, test/num_examples=89274637, total_duration=4415.424576, train/loss=0.131629, validation/loss=0.131567, validation/num_examples=89000000
I0420 23:25:34.500614 139749654058816 checkpoints.py:356] Saving checkpoint at step: 951
I0420 23:25:54.503880 139749654058816 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_951
I0420 23:25:54.680012 139749654058816 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_951.
I0420 23:26:22.032464 139483290760960 logging_writer.py:48] [1000] global_step=1000, grad_norm=0.06443079560995102, loss=0.12944787740707397
I0420 23:28:07.482743 139525780096768 logging_writer.py:48] [1100] global_step=1100, grad_norm=0.09697473049163818, loss=0.13067704439163208
I0420 23:29:59.182574 139483290760960 logging_writer.py:48] [1200] global_step=1200, grad_norm=0.011204024776816368, loss=0.12897354364395142
I0420 23:32:05.947843 139525780096768 logging_writer.py:48] [1300] global_step=1300, grad_norm=0.11083973944187164, loss=0.12994267046451569
I0420 23:34:34.637915 139483290760960 logging_writer.py:48] [1400] global_step=1400, grad_norm=0.10762444138526917, loss=0.1299068182706833
I0420 23:34:55.099675 139749654058816 spec.py:298] Evaluating on the training split.
I0420 23:44:31.497898 139749654058816 spec.py:310] Evaluating on the validation split.
I0420 23:48:23.612721 139749654058816 spec.py:326] Evaluating on the test split.
I0420 23:52:54.746591 139749654058816 submission_runner.py:406] Time since start: 6059.25s, 	Step: 1414, 	{'train/loss': 0.12934840681624815, 'validation/loss': 0.13046169662921347, 'validation/num_examples': 89000000, 'test/loss': 0.13329864337616965, 'test/num_examples': 89274637, 'score': 1787.560308456421, 'total_duration': 6059.253635406494, 'accumulated_submission_time': 1787.560308456421, 'accumulated_eval_time': 4212.078203678131, 'accumulated_logging_time': 59.59960389137268}
I0420 23:52:54.755590 139480488974080 logging_writer.py:48] [1414] accumulated_eval_time=4212.078204, accumulated_logging_time=59.599604, accumulated_submission_time=1787.560308, global_step=1414, preemption_count=0, score=1787.560308, test/loss=0.133299, test/num_examples=89274637, total_duration=6059.253635, train/loss=0.129348, validation/loss=0.130462, validation/num_examples=89000000
I0420 23:52:58.336318 139749654058816 checkpoints.py:356] Saving checkpoint at step: 1414
I0420 23:53:18.634160 139749654058816 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1414
I0420 23:53:18.812541 139749654058816 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1414.
I0420 23:54:40.355556 139480338003712 logging_writer.py:48] [1500] global_step=1500, grad_norm=0.08860697597265244, loss=0.12746040523052216
I0420 23:56:25.633684 139749654058816 spec.py:298] Evaluating on the training split.
I0421 00:05:44.115285 139749654058816 spec.py:310] Evaluating on the validation split.
I0421 00:09:43.956064 139749654058816 spec.py:326] Evaluating on the test split.
I0421 00:14:14.009098 139749654058816 submission_runner.py:406] Time since start: 7338.52s, 	Step: 1600, 	{'train/loss': 0.12852764340162803, 'validation/loss': 0.12931823595505618, 'validation/num_examples': 89000000, 'test/loss': 0.132045868749934, 'test/num_examples': 89274637, 'score': 1974.1817314624786, 'total_duration': 7338.516167640686, 'accumulated_submission_time': 1974.1817314624786, 'accumulated_eval_time': 5280.45356965065, 'accumulated_logging_time': 83.86325407028198}
I0421 00:14:14.017316 139480002459392 logging_writer.py:48] [1600] accumulated_eval_time=5280.453570, accumulated_logging_time=83.863254, accumulated_submission_time=1974.181731, global_step=1600, preemption_count=0, score=1974.181731, test/loss=0.132046, test/num_examples=89274637, total_duration=7338.516168, train/loss=0.128528, validation/loss=0.129318, validation/num_examples=89000000
I0421 00:14:17.570562 139749654058816 checkpoints.py:356] Saving checkpoint at step: 1600
I0421 00:14:36.832003 139749654058816 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1600
I0421 00:14:37.026202 139749654058816 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1600.
I0421 00:14:37.223927 139480338003712 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=1974.181731
I0421 00:14:40.510334 139749654058816 checkpoints.py:356] Saving checkpoint at step: 1600
I0421 00:15:05.319028 139749654058816 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1600
I0421 00:15:05.517702 139749654058816 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3_b/timing_momentum/criteo1tb_jax/trial_1/checkpoint_1600.
I0421 00:16:27.260733 139749654058816 submission_runner.py:567] Tuning trial 1/1
I0421 00:16:27.262596 139749654058816 submission_runner.py:568] Hyperparameters: Hyperparameters(learning_rate=0.4394877561366806, one_minus_beta1=0.07113602458522507, warmup_factor=0.05, weight_decay=9.611851572925426e-07, label_smoothing=0.2, dropout_rate=0.0, decay_steps_factor=0.9, end_factor=0.001)
I0421 00:16:27.266130 139749654058816 submission_runner.py:569] Metrics: {'eval_results': [(1, {'train/loss': 3.284140524397535, 'validation/loss': 3.285534202247191, 'validation/num_examples': 89000000, 'test/loss': 3.2832699840605346, 'test/num_examples': 89274637, 'score': 165.99319291114807, 'total_duration': 1204.0960838794708, 'accumulated_submission_time': 165.99319291114807, 'accumulated_eval_time': 1038.1025958061218, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (487, {'train/loss': 0.13551573090205918, 'validation/loss': 0.13605140449438202, 'validation/num_examples': 89000000, 'test/loss': 0.13915681337354527, 'test/num_examples': 89274637, 'score': 706.5057873725891, 'total_duration': 2777.838493824005, 'accumulated_submission_time': 706.5057873725891, 'accumulated_eval_time': 2059.1230585575104, 'accumulated_logging_time': 12.20443606376648, 'global_step': 487, 'preemption_count': 0}), (951, {'train/loss': 0.13162886035012533, 'validation/loss': 0.13156655056179775, 'validation/num_examples': 89000000, 'test/loss': 0.13440093853307966, 'test/num_examples': 89274637, 'score': 1247.3382697105408, 'total_duration': 4415.424575805664, 'accumulated_submission_time': 1247.3382697105408, 'accumulated_eval_time': 3132.4313611984253, 'accumulated_logging_time': 35.6445996761322, 'global_step': 951, 'preemption_count': 0}), (1414, {'train/loss': 0.12934840681624815, 'validation/loss': 0.13046169662921347, 'validation/num_examples': 89000000, 'test/loss': 0.13329864337616965, 'test/num_examples': 89274637, 'score': 1787.560308456421, 'total_duration': 6059.253635406494, 'accumulated_submission_time': 1787.560308456421, 'accumulated_eval_time': 4212.078203678131, 'accumulated_logging_time': 59.59960389137268, 'global_step': 1414, 'preemption_count': 0}), (1600, {'train/loss': 0.12852764340162803, 'validation/loss': 0.12931823595505618, 'validation/num_examples': 89000000, 'test/loss': 0.132045868749934, 'test/num_examples': 89274637, 'score': 1974.1817314624786, 'total_duration': 7338.516167640686, 'accumulated_submission_time': 1974.1817314624786, 'accumulated_eval_time': 5280.45356965065, 'accumulated_logging_time': 83.86325407028198, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0421 00:16:27.266256 139749654058816 submission_runner.py:570] Timing: 1974.1817314624786
I0421 00:16:27.266296 139749654058816 submission_runner.py:571] ====================
I0421 00:16:27.266387 139749654058816 submission_runner.py:631] Final criteo1tb score: 1974.1817314624786
