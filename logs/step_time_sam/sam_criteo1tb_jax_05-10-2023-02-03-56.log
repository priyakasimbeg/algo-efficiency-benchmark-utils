python3 submission_runner.py --framework=jax --workload=criteo1tb --submission_path=baselines/sam/jax/submission.py --tuning_search_space=baselines/sam/tuning_search_space.json --data_dir=/data/criteo1tb --num_tuning_trials=1 --experiment_dir=/experiment_runs --experiment_name=timing_fancy_verify_no_updates/timing_sam --overwrite=True --save_checkpoints=False --max_global_steps=1600 2>&1 | tee -a /logs/criteo1tb_jax_05-10-2023-02-03-56.log
I0510 02:04:16.842702 140507697370944 logger_utils.py:76] Creating experiment directory at /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax.
I0510 02:04:16.995459 140507697370944 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0510 02:04:17.920885 140507697370944 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: CUDA Host Interpreter
I0510 02:04:17.921545 140507697370944 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0510 02:04:17.929855 140507697370944 submission_runner.py:544] Using RNG seed 2093837611
I0510 02:04:20.783291 140507697370944 submission_runner.py:553] --- Tuning run 1/1 ---
I0510 02:04:20.783491 140507697370944 submission_runner.py:558] Creating tuning directory at /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax/trial_1.
I0510 02:04:20.783671 140507697370944 logger_utils.py:92] Saving hparams to /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax/trial_1/hparams.json.
I0510 02:04:20.922774 140507697370944 submission_runner.py:241] Initializing dataset.
I0510 02:04:20.922976 140507697370944 submission_runner.py:248] Initializing model.
I0510 02:04:27.087446 140507697370944 submission_runner.py:258] Initializing optimizer.
I0510 02:04:29.805586 140507697370944 submission_runner.py:265] Initializing metrics bundle.
I0510 02:04:29.805794 140507697370944 submission_runner.py:283] Initializing checkpoint and logger.
I0510 02:04:29.810416 140507697370944 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax/trial_1 with prefix checkpoint_
I0510 02:04:29.810741 140507697370944 logger_utils.py:239] Unable to record workload.train_mean information. Continuing without it.
I0510 02:04:29.810825 140507697370944 logger_utils.py:239] Unable to record workload.train_stddev information. Continuing without it.
I0510 02:04:30.518039 140507697370944 submission_runner.py:304] Saving meta data to /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax/trial_1/meta_data_0.json.
I0510 02:04:30.519039 140507697370944 submission_runner.py:307] Saving flags to /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax/trial_1/flags_0.json.
I0510 02:04:30.573909 140507697370944 submission_runner.py:319] Starting training loop.
I0510 02:04:34.735149 140507697370944 spec.py:298] Evaluating on the training split.
I0510 02:09:41.542871 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 02:14:48.262164 140507697370944 spec.py:326] Evaluating on the test split.
I0510 02:19:52.322125 140507697370944 submission_runner.py:421] Time since start: 921.75s, 	Step: 1, 	{'train/loss': 0.2578087498634681, 'validation/loss': 0.258912, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 4.16101336479187, 'total_duration': 921.7481265068054, 'accumulated_submission_time': 4.16101336479187, 'accumulated_eval_time': 917.58691573143, 'accumulated_logging_time': 0}
I0510 02:19:52.330332 140324449949440 logging_writer.py:48] [1] accumulated_eval_time=917.586916, accumulated_logging_time=0, accumulated_submission_time=4.161013, global_step=1, preemption_count=0, score=4.161013, test/loss=0.260312, test/num_examples=89274637, total_duration=921.748127, train/loss=0.257809, validation/loss=0.258912, validation/num_examples=89000000
I0510 02:21:52.369053 140507697370944 spec.py:298] Evaluating on the training split.
I0510 02:26:56.771674 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 02:31:41.944567 140507697370944 spec.py:326] Evaluating on the test split.
I0510 02:36:41.199349 140507697370944 submission_runner.py:421] Time since start: 1930.63s, 	Step: 157, 	{'train/loss': 0.2578567381375322, 'validation/loss': 0.258890202247191, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 124.1879415512085, 'total_duration': 1930.6253380775452, 'accumulated_submission_time': 124.1879415512085, 'accumulated_eval_time': 1806.4171488285065, 'accumulated_logging_time': 0.018355607986450195}
I0510 02:36:41.219159 140324231968512 logging_writer.py:48] [157] accumulated_eval_time=1806.417149, accumulated_logging_time=0.018356, accumulated_submission_time=124.187942, global_step=157, preemption_count=0, score=124.187942, test/loss=0.260312, test/num_examples=89274637, total_duration=1930.625338, train/loss=0.257857, validation/loss=0.258890, validation/num_examples=89000000
I0510 02:38:42.004329 140507697370944 spec.py:298] Evaluating on the training split.
I0510 02:43:45.568826 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 02:48:28.102356 140507697370944 spec.py:326] Evaluating on the test split.
I0510 02:53:12.313627 140507697370944 submission_runner.py:421] Time since start: 2921.74s, 	Step: 313, 	{'train/loss': 0.2574240801701044, 'validation/loss': 0.258852606741573, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 244.96370601654053, 'total_duration': 2921.7396104335785, 'accumulated_submission_time': 244.96370601654053, 'accumulated_eval_time': 2676.726392507553, 'accumulated_logging_time': 0.04585981369018555}
I0510 02:53:12.321702 140324449949440 logging_writer.py:48] [313] accumulated_eval_time=2676.726393, accumulated_logging_time=0.045860, accumulated_submission_time=244.963706, global_step=313, preemption_count=0, score=244.963706, test/loss=0.260312, test/num_examples=89274637, total_duration=2921.739610, train/loss=0.257424, validation/loss=0.258853, validation/num_examples=89000000
I0510 02:55:13.064868 140507697370944 spec.py:298] Evaluating on the training split.
I0510 03:00:13.580678 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 03:04:57.219041 140507697370944 spec.py:326] Evaluating on the test split.
I0510 03:09:45.215650 140507697370944 submission_runner.py:421] Time since start: 3914.64s, 	Step: 480, 	{'train/loss': 0.2581234694053532, 'validation/loss': 0.25881622471910115, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 365.69856119155884, 'total_duration': 3914.641654729843, 'accumulated_submission_time': 365.69856119155884, 'accumulated_eval_time': 3548.877145767212, 'accumulated_logging_time': 0.06038522720336914}
I0510 03:09:45.223656 140324231968512 logging_writer.py:48] [480] accumulated_eval_time=3548.877146, accumulated_logging_time=0.060385, accumulated_submission_time=365.698561, global_step=480, preemption_count=0, score=365.698561, test/loss=0.260312, test/num_examples=89274637, total_duration=3914.641655, train/loss=0.258123, validation/loss=0.258816, validation/num_examples=89000000
I0510 03:11:46.116089 140507697370944 spec.py:298] Evaluating on the training split.
I0510 03:16:46.425031 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 03:21:29.201604 140507697370944 spec.py:326] Evaluating on the test split.
I0510 03:26:18.276959 140507697370944 submission_runner.py:421] Time since start: 4907.70s, 	Step: 634, 	{'train/loss': 0.2578404800605914, 'validation/loss': 0.25883357303370785, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 486.5830309391022, 'total_duration': 4907.702962636948, 'accumulated_submission_time': 486.5830309391022, 'accumulated_eval_time': 4421.037970066071, 'accumulated_logging_time': 0.07488346099853516}
I0510 03:26:18.284989 140324449949440 logging_writer.py:48] [634] accumulated_eval_time=4421.037970, accumulated_logging_time=0.074883, accumulated_submission_time=486.583031, global_step=634, preemption_count=0, score=486.583031, test/loss=0.260312, test/num_examples=89274637, total_duration=4907.702963, train/loss=0.257840, validation/loss=0.258834, validation/num_examples=89000000
I0510 03:28:18.673801 140507697370944 spec.py:298] Evaluating on the training split.
I0510 03:33:14.748272 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 03:37:54.344518 140507697370944 spec.py:326] Evaluating on the test split.
I0510 03:42:39.976196 140507697370944 submission_runner.py:421] Time since start: 5889.40s, 	Step: 800, 	{'train/loss': 0.25875093236927427, 'validation/loss': 0.2588518426966292, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 606.9636402130127, 'total_duration': 5889.402193069458, 'accumulated_submission_time': 606.9636402130127, 'accumulated_eval_time': 5282.340308189392, 'accumulated_logging_time': 0.08949971199035645}
I0510 03:42:39.984268 140324231968512 logging_writer.py:48] [800] accumulated_eval_time=5282.340308, accumulated_logging_time=0.089500, accumulated_submission_time=606.963640, global_step=800, preemption_count=0, score=606.963640, test/loss=0.260312, test/num_examples=89274637, total_duration=5889.402193, train/loss=0.258751, validation/loss=0.258852, validation/num_examples=89000000
I0510 03:44:40.690071 140507697370944 spec.py:298] Evaluating on the training split.
I0510 03:49:33.164686 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 03:54:13.808149 140507697370944 spec.py:326] Evaluating on the test split.
I0510 03:59:02.298530 140507697370944 submission_runner.py:421] Time since start: 6871.72s, 	Step: 966, 	{'train/loss': 0.257041633611571, 'validation/loss': 0.2588954831460674, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 727.6606504917145, 'total_duration': 6871.72450876236, 'accumulated_submission_time': 727.6606504917145, 'accumulated_eval_time': 6143.948739528656, 'accumulated_logging_time': 0.10426950454711914}
I0510 03:59:02.306213 140324449949440 logging_writer.py:48] [966] accumulated_eval_time=6143.948740, accumulated_logging_time=0.104270, accumulated_submission_time=727.660650, global_step=966, preemption_count=0, score=727.660650, test/loss=0.260312, test/num_examples=89274637, total_duration=6871.724509, train/loss=0.257042, validation/loss=0.258895, validation/num_examples=89000000
I0510 04:01:02.749873 140507697370944 spec.py:298] Evaluating on the training split.
I0510 04:06:08.625950 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 04:10:49.794680 140507697370944 spec.py:326] Evaluating on the test split.
I0510 04:15:40.982666 140507697370944 submission_runner.py:421] Time since start: 7870.41s, 	Step: 1123, 	{'train/loss': 0.2585198610823676, 'validation/loss': 0.25891748314606744, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 848.09587931633, 'total_duration': 7870.4086701869965, 'accumulated_submission_time': 848.09587931633, 'accumulated_eval_time': 7022.181491136551, 'accumulated_logging_time': 0.11881780624389648}
I0510 04:15:40.990391 140324231968512 logging_writer.py:48] [1123] accumulated_eval_time=7022.181491, accumulated_logging_time=0.118818, accumulated_submission_time=848.095879, global_step=1123, preemption_count=0, score=848.095879, test/loss=0.260312, test/num_examples=89274637, total_duration=7870.408670, train/loss=0.258520, validation/loss=0.258917, validation/num_examples=89000000
I0510 04:17:41.061177 140507697370944 spec.py:298] Evaluating on the training split.
I0510 04:22:44.909276 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 04:27:25.664347 140507697370944 spec.py:326] Evaluating on the test split.
I0510 04:32:11.473892 140507697370944 submission_runner.py:421] Time since start: 8860.90s, 	Step: 1279, 	{'train/loss': 0.2584328893530974, 'validation/loss': 0.2589019101123595, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 968.1587505340576, 'total_duration': 8860.899888277054, 'accumulated_submission_time': 968.1587505340576, 'accumulated_eval_time': 7892.594154834747, 'accumulated_logging_time': 0.13296294212341309}
I0510 04:32:11.482937 140324449949440 logging_writer.py:48] [1279] accumulated_eval_time=7892.594155, accumulated_logging_time=0.132963, accumulated_submission_time=968.158751, global_step=1279, preemption_count=0, score=968.158751, test/loss=0.260312, test/num_examples=89274637, total_duration=8860.899888, train/loss=0.258433, validation/loss=0.258902, validation/num_examples=89000000
I0510 04:34:11.776988 140507697370944 spec.py:298] Evaluating on the training split.
I0510 04:39:04.059698 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 04:43:42.636216 140507697370944 spec.py:326] Evaluating on the test split.
I0510 04:48:31.088490 140507697370944 submission_runner.py:421] Time since start: 9840.51s, 	Step: 1442, 	{'train/loss': 0.25733423408469003, 'validation/loss': 0.2588907640449438, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 1088.4447758197784, 'total_duration': 9840.514489412308, 'accumulated_submission_time': 1088.4447758197784, 'accumulated_eval_time': 8751.905606269836, 'accumulated_logging_time': 0.14841771125793457}
I0510 04:48:31.096940 140324231968512 logging_writer.py:48] [1442] accumulated_eval_time=8751.905606, accumulated_logging_time=0.148418, accumulated_submission_time=1088.444776, global_step=1442, preemption_count=0, score=1088.444776, test/loss=0.260312, test/num_examples=89274637, total_duration=9840.514489, train/loss=0.257334, validation/loss=0.258891, validation/num_examples=89000000
I0510 04:50:26.770797 140507697370944 spec.py:298] Evaluating on the training split.
I0510 04:55:27.133705 140507697370944 spec.py:310] Evaluating on the validation split.
I0510 05:00:08.599569 140507697370944 spec.py:326] Evaluating on the test split.
I0510 05:05:02.913299 140507697370944 submission_runner.py:421] Time since start: 10832.34s, 	Step: 1600, 	{'train/loss': 0.25820316542063326, 'validation/loss': 0.2589279775280899, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 1204.1106786727905, 'total_duration': 10832.339282751083, 'accumulated_submission_time': 1204.1106786727905, 'accumulated_eval_time': 9628.048043251038, 'accumulated_logging_time': 0.16327524185180664}
I0510 05:05:02.922637 140324449949440 logging_writer.py:48] [1600] accumulated_eval_time=9628.048043, accumulated_logging_time=0.163275, accumulated_submission_time=1204.110679, global_step=1600, preemption_count=0, score=1204.110679, test/loss=0.260312, test/num_examples=89274637, total_duration=10832.339283, train/loss=0.258203, validation/loss=0.258928, validation/num_examples=89000000
I0510 05:05:02.937401 140324231968512 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=1204.110679
I0510 05:05:06.879531 140507697370944 checkpoints.py:356] Saving checkpoint at step: 1600
I0510 05:05:30.603719 140507697370944 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax/trial_1/checkpoint_1600
I0510 05:05:30.618965 140507697370944 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_fancy_verify_no_updates/timing_sam/criteo1tb_jax/trial_1/checkpoint_1600.
I0510 05:05:30.676275 140507697370944 submission_runner.py:584] Tuning trial 1/1
I0510 05:05:30.676519 140507697370944 submission_runner.py:585] Hyperparameters: Hyperparameters(learning_rate=0.0013159053452895648, one_minus_beta1=0.2018302260773442, beta2=0.999, warmup_factor=0.05, weight_decay=0.07935861128365443, label_smoothing=0.1, dropout_rate=0.0, rho=0.01)
I0510 05:05:30.676837 140507697370944 submission_runner.py:586] Metrics: {'eval_results': [(1, {'train/loss': 0.2578087498634681, 'validation/loss': 0.258912, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 4.16101336479187, 'total_duration': 921.7481265068054, 'accumulated_submission_time': 4.16101336479187, 'accumulated_eval_time': 917.58691573143, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (157, {'train/loss': 0.2578567381375322, 'validation/loss': 0.258890202247191, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 124.1879415512085, 'total_duration': 1930.6253380775452, 'accumulated_submission_time': 124.1879415512085, 'accumulated_eval_time': 1806.4171488285065, 'accumulated_logging_time': 0.018355607986450195, 'global_step': 157, 'preemption_count': 0}), (313, {'train/loss': 0.2574240801701044, 'validation/loss': 0.258852606741573, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 244.96370601654053, 'total_duration': 2921.7396104335785, 'accumulated_submission_time': 244.96370601654053, 'accumulated_eval_time': 2676.726392507553, 'accumulated_logging_time': 0.04585981369018555, 'global_step': 313, 'preemption_count': 0}), (480, {'train/loss': 0.2581234694053532, 'validation/loss': 0.25881622471910115, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 365.69856119155884, 'total_duration': 3914.641654729843, 'accumulated_submission_time': 365.69856119155884, 'accumulated_eval_time': 3548.877145767212, 'accumulated_logging_time': 0.06038522720336914, 'global_step': 480, 'preemption_count': 0}), (634, {'train/loss': 0.2578404800605914, 'validation/loss': 0.25883357303370785, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 486.5830309391022, 'total_duration': 4907.702962636948, 'accumulated_submission_time': 486.5830309391022, 'accumulated_eval_time': 4421.037970066071, 'accumulated_logging_time': 0.07488346099853516, 'global_step': 634, 'preemption_count': 0}), (800, {'train/loss': 0.25875093236927427, 'validation/loss': 0.2588518426966292, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 606.9636402130127, 'total_duration': 5889.402193069458, 'accumulated_submission_time': 606.9636402130127, 'accumulated_eval_time': 5282.340308189392, 'accumulated_logging_time': 0.08949971199035645, 'global_step': 800, 'preemption_count': 0}), (966, {'train/loss': 0.257041633611571, 'validation/loss': 0.2588954831460674, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 727.6606504917145, 'total_duration': 6871.72450876236, 'accumulated_submission_time': 727.6606504917145, 'accumulated_eval_time': 6143.948739528656, 'accumulated_logging_time': 0.10426950454711914, 'global_step': 966, 'preemption_count': 0}), (1123, {'train/loss': 0.2585198610823676, 'validation/loss': 0.25891748314606744, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 848.09587931633, 'total_duration': 7870.4086701869965, 'accumulated_submission_time': 848.09587931633, 'accumulated_eval_time': 7022.181491136551, 'accumulated_logging_time': 0.11881780624389648, 'global_step': 1123, 'preemption_count': 0}), (1279, {'train/loss': 0.2584328893530974, 'validation/loss': 0.2589019101123595, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 968.1587505340576, 'total_duration': 8860.899888277054, 'accumulated_submission_time': 968.1587505340576, 'accumulated_eval_time': 7892.594154834747, 'accumulated_logging_time': 0.13296294212341309, 'global_step': 1279, 'preemption_count': 0}), (1442, {'train/loss': 0.25733423408469003, 'validation/loss': 0.2588907640449438, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 1088.4447758197784, 'total_duration': 9840.514489412308, 'accumulated_submission_time': 1088.4447758197784, 'accumulated_eval_time': 8751.905606269836, 'accumulated_logging_time': 0.14841771125793457, 'global_step': 1442, 'preemption_count': 0}), (1600, {'train/loss': 0.25820316542063326, 'validation/loss': 0.2589279775280899, 'validation/num_examples': 89000000, 'test/loss': 0.2603123438071218, 'test/num_examples': 89274637, 'score': 1204.1106786727905, 'total_duration': 10832.339282751083, 'accumulated_submission_time': 1204.1106786727905, 'accumulated_eval_time': 9628.048043251038, 'accumulated_logging_time': 0.16327524185180664, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0510 05:05:30.676915 140507697370944 submission_runner.py:587] Timing: 1204.1106786727905
I0510 05:05:30.676968 140507697370944 submission_runner.py:588] ====================
I0510 05:05:30.677081 140507697370944 submission_runner.py:651] Final criteo1tb score: 1204.1106786727905
