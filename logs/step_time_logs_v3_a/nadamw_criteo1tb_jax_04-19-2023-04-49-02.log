I0419 04:49:21.761256 140369735386944 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax.
I0419 04:49:21.904490 140369735386944 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0419 04:49:22.718318 140369735386944 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: CUDA Host Interpreter
I0419 04:49:22.719138 140369735386944 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0419 04:49:22.723788 140369735386944 submission_runner.py:528] Using RNG seed 2569249888
I0419 04:49:25.254319 140369735386944 submission_runner.py:537] --- Tuning run 1/1 ---
I0419 04:49:25.254498 140369735386944 submission_runner.py:542] Creating tuning directory at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1.
I0419 04:49:25.254676 140369735386944 logger_utils.py:83] Saving hparams to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/hparams.json.
I0419 04:49:25.377959 140369735386944 submission_runner.py:232] Initializing dataset.
I0419 04:49:25.378117 140369735386944 submission_runner.py:239] Initializing model.
I0419 04:49:31.318075 140369735386944 submission_runner.py:249] Initializing optimizer.
I0419 04:49:34.138306 140369735386944 submission_runner.py:256] Initializing metrics bundle.
I0419 04:49:34.138511 140369735386944 submission_runner.py:273] Initializing checkpoint and logger.
I0419 04:49:34.142701 140369735386944 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1 with prefix checkpoint_
I0419 04:49:34.143003 140369735386944 logger_utils.py:230] Unable to record workload.train_mean information. Continuing without it.
I0419 04:49:34.143076 140369735386944 logger_utils.py:230] Unable to record workload.train_stddev information. Continuing without it.
I0419 04:49:34.791052 140369735386944 submission_runner.py:294] Saving meta data to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/meta_data_0.json.
I0419 04:49:34.791911 140369735386944 submission_runner.py:297] Saving flags to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/flags_0.json.
I0419 04:49:34.839967 140369735386944 submission_runner.py:309] Starting training loop.
I0419 04:52:28.609139 140163516712704 logging_writer.py:48] [0] global_step=0, grad_norm=2.364551067352295, loss=0.263412743806839
I0419 04:52:28.626921 140369735386944 spec.py:298] Evaluating on the training split.
I0419 05:01:05.693804 140369735386944 spec.py:310] Evaluating on the validation split.
I0419 05:05:14.434929 140369735386944 spec.py:326] Evaluating on the test split.
I0419 05:09:36.300972 140369735386944 submission_runner.py:406] Time since start: 1201.46s, 	Step: 1, 	{'train/loss': 0.26264718949049165, 'validation/loss': 0.2635987415730337, 'validation/num_examples': 89000000, 'test/loss': 0.26469166152980267, 'test/num_examples': 89274637, 'score': 173.78676676750183, 'total_duration': 1201.4609160423279, 'accumulated_submission_time': 173.78676676750183, 'accumulated_eval_time': 1027.6739678382874, 'accumulated_logging_time': 0}
I0419 05:09:36.317608 140109491963648 logging_writer.py:48] [1] accumulated_eval_time=1027.673968, accumulated_logging_time=0, accumulated_submission_time=173.786767, global_step=1, preemption_count=0, score=173.786767, test/loss=0.264692, test/num_examples=89274637, total_duration=1201.460916, train/loss=0.262647, validation/loss=0.263599, validation/num_examples=89000000
I0419 05:09:38.726870 140369735386944 checkpoints.py:356] Saving checkpoint at step: 1
I0419 05:09:54.439337 140369735386944 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1
I0419 05:09:54.451243 140369735386944 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1.
I0419 05:12:00.028188 140109483570944 logging_writer.py:48] [100] global_step=100, grad_norm=0.01032341830432415, loss=0.1291642189025879
I0419 05:13:53.377763 140109450000128 logging_writer.py:48] [200] global_step=200, grad_norm=0.01147381216287613, loss=0.12714171409606934
I0419 05:15:46.918480 140109483570944 logging_writer.py:48] [300] global_step=300, grad_norm=0.011770901270210743, loss=0.12478230893611908
I0419 05:17:44.947768 140109450000128 logging_writer.py:48] [400] global_step=400, grad_norm=0.019608350470662117, loss=0.12528899312019348
I0419 05:18:55.126446 140369735386944 spec.py:298] Evaluating on the training split.
I0419 05:28:55.316947 140369735386944 spec.py:310] Evaluating on the validation split.
I0419 05:32:42.079682 140369735386944 spec.py:326] Evaluating on the test split.
I0419 05:36:12.109808 140369735386944 submission_runner.py:406] Time since start: 2797.27s, 	Step: 445, 	{'train/loss': 0.1251121335734858, 'validation/loss': 0.126544, 'validation/num_examples': 89000000, 'test/loss': 0.12892242843843768, 'test/num_examples': 89274637, 'score': 714.4456994533539, 'total_duration': 2797.269735813141, 'accumulated_submission_time': 714.4456994533539, 'accumulated_eval_time': 2064.657245874405, 'accumulated_logging_time': 18.162206411361694}
I0419 05:36:12.118432 140161643943680 logging_writer.py:48] [445] accumulated_eval_time=2064.657246, accumulated_logging_time=18.162206, accumulated_submission_time=714.445699, global_step=445, preemption_count=0, score=714.445699, test/loss=0.128922, test/num_examples=89274637, total_duration=2797.269736, train/loss=0.125112, validation/loss=0.126544, validation/num_examples=89000000
I0419 05:36:17.409819 140369735386944 checkpoints.py:356] Saving checkpoint at step: 445
I0419 05:36:46.838626 140369735386944 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_445
I0419 05:36:47.094323 140369735386944 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_445.
I0419 05:37:31.471519 140160553449216 logging_writer.py:48] [500] global_step=500, grad_norm=0.026161160320043564, loss=0.12577922642230988
I0419 05:39:22.291355 140156250089216 logging_writer.py:48] [600] global_step=600, grad_norm=0.01755722612142563, loss=0.12337625026702881
I0419 05:41:57.843175 140160553449216 logging_writer.py:48] [700] global_step=700, grad_norm=0.006305760238319635, loss=0.12557975947856903
I0419 05:43:56.963299 140156250089216 logging_writer.py:48] [800] global_step=800, grad_norm=0.00798872485756874, loss=0.12546990811824799
I0419 05:45:47.730615 140369735386944 spec.py:298] Evaluating on the training split.
I0419 05:55:40.809644 140369735386944 spec.py:310] Evaluating on the validation split.
I0419 05:59:35.325781 140369735386944 spec.py:326] Evaluating on the test split.
I0419 06:03:49.559776 140369735386944 submission_runner.py:406] Time since start: 4454.72s, 	Step: 899, 	{'train/loss': 0.12426039223463944, 'validation/loss': 0.12556893258426965, 'validation/num_examples': 89000000, 'test/loss': 0.1278880137031529, 'test/num_examples': 89274637, 'score': 1254.794733285904, 'total_duration': 4454.71968460083, 'accumulated_submission_time': 1254.794733285904, 'accumulated_eval_time': 3146.4863052368164, 'accumulated_logging_time': 53.4296441078186}
I0419 06:03:49.567865 140160553449216 logging_writer.py:48] [899] accumulated_eval_time=3146.486305, accumulated_logging_time=53.429644, accumulated_submission_time=1254.794733, global_step=899, preemption_count=0, score=1254.794733, test/loss=0.127888, test/num_examples=89274637, total_duration=4454.719685, train/loss=0.124260, validation/loss=0.125569, validation/num_examples=89000000
I0419 06:03:54.935632 140369735386944 checkpoints.py:356] Saving checkpoint at step: 899
I0419 06:04:24.503000 140369735386944 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_899
I0419 06:04:24.763878 140369735386944 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_899.
I0419 06:04:25.284524 140156250089216 logging_writer.py:48] [900] global_step=900, grad_norm=0.013206887990236282, loss=0.1274717003107071
I0419 06:05:49.621064 140156241696512 logging_writer.py:48] [1000] global_step=1000, grad_norm=0.009896110743284225, loss=0.12404578924179077
I0419 06:07:40.973864 140156250089216 logging_writer.py:48] [1100] global_step=1100, grad_norm=0.01887313835322857, loss=0.12201417237520218
I0419 06:09:38.002202 140156241696512 logging_writer.py:48] [1200] global_step=1200, grad_norm=0.011811412870883942, loss=0.12454000115394592
I0419 06:11:42.132324 140156250089216 logging_writer.py:48] [1300] global_step=1300, grad_norm=0.005585924722254276, loss=0.12368957698345184
I0419 06:13:25.840136 140369735386944 spec.py:298] Evaluating on the training split.
I0419 06:23:19.187573 140369735386944 spec.py:310] Evaluating on the validation split.
I0419 06:27:17.406386 140369735386944 spec.py:326] Evaluating on the test split.
I0419 06:31:17.952112 140369735386944 submission_runner.py:406] Time since start: 6103.11s, 	Step: 1384, 	{'train/loss': 0.12422206000074733, 'validation/loss': 0.1251772808988764, 'validation/num_examples': 89000000, 'test/loss': 0.12753689494139303, 'test/num_examples': 89274637, 'score': 1795.5798425674438, 'total_duration': 6103.112063884735, 'accumulated_submission_time': 1795.5798425674438, 'accumulated_eval_time': 4218.598219394684, 'accumulated_logging_time': 88.92007398605347}
I0419 06:31:17.961023 140156241696512 logging_writer.py:48] [1384] accumulated_eval_time=4218.598219, accumulated_logging_time=88.920074, accumulated_submission_time=1795.579843, global_step=1384, preemption_count=0, score=1795.579843, test/loss=0.127537, test/num_examples=89274637, total_duration=6103.112064, train/loss=0.124222, validation/loss=0.125177, validation/num_examples=89000000
I0419 06:31:23.333206 140369735386944 checkpoints.py:356] Saving checkpoint at step: 1384
I0419 06:31:53.548219 140369735386944 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1384
I0419 06:31:53.817715 140369735386944 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1384.
I0419 06:31:55.973720 140156250089216 logging_writer.py:48] [1400] global_step=1400, grad_norm=0.012556410394608974, loss=0.12177649140357971
I0419 06:33:33.943660 140156233303808 logging_writer.py:48] [1500] global_step=1500, grad_norm=0.008183585479855537, loss=0.1247008740901947
I0419 06:35:25.310808 140369735386944 spec.py:298] Evaluating on the training split.
I0419 06:45:08.519871 140369735386944 spec.py:310] Evaluating on the validation split.
I0419 06:49:05.926347 140369735386944 spec.py:326] Evaluating on the test split.
I0419 06:53:13.001393 140369735386944 submission_runner.py:406] Time since start: 7418.16s, 	Step: 1600, 	{'train/loss': 0.12387160188227211, 'validation/loss': 0.12506288764044943, 'validation/num_examples': 89000000, 'test/loss': 0.12740793334169478, 'test/num_examples': 89274637, 'score': 2006.7498111724854, 'total_duration': 7418.161320924759, 'accumulated_submission_time': 2006.7498111724854, 'accumulated_eval_time': 5286.28875207901, 'accumulated_logging_time': 125.10662961006165}
I0419 06:53:13.010286 140156250089216 logging_writer.py:48] [1600] accumulated_eval_time=5286.288752, accumulated_logging_time=125.106630, accumulated_submission_time=2006.749811, global_step=1600, preemption_count=0, score=2006.749811, test/loss=0.127408, test/num_examples=89274637, total_duration=7418.161321, train/loss=0.123872, validation/loss=0.125063, validation/num_examples=89000000
I0419 06:53:18.389923 140369735386944 checkpoints.py:356] Saving checkpoint at step: 1600
I0419 06:53:48.427225 140369735386944 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600
I0419 06:53:48.746921 140369735386944 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0419 06:53:49.044256 140156233303808 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=2006.749811
I0419 06:53:54.093095 140369735386944 checkpoints.py:356] Saving checkpoint at step: 1600
I0419 06:54:31.554356 140369735386944 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600
I0419 06:54:31.868758 140369735386944 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_nadamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0419 06:55:53.463635 140369735386944 submission_runner.py:567] Tuning trial 1/1
I0419 06:55:53.464674 140369735386944 submission_runner.py:568] Hyperparameters: Hyperparameters(learning_rate=0.0019814680146414726, one_minus_beta1=0.045677535963609565, beta2=0.999, warmup_factor=0.05, weight_decay=0.010340635370188849, label_smoothing=0.1, dropout_rate=0.0)
I0419 06:55:53.465665 140369735386944 submission_runner.py:569] Metrics: {'eval_results': [(1, {'train/loss': 0.26264718949049165, 'validation/loss': 0.2635987415730337, 'validation/num_examples': 89000000, 'test/loss': 0.26469166152980267, 'test/num_examples': 89274637, 'score': 173.78676676750183, 'total_duration': 1201.4609160423279, 'accumulated_submission_time': 173.78676676750183, 'accumulated_eval_time': 1027.6739678382874, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (445, {'train/loss': 0.1251121335734858, 'validation/loss': 0.126544, 'validation/num_examples': 89000000, 'test/loss': 0.12892242843843768, 'test/num_examples': 89274637, 'score': 714.4456994533539, 'total_duration': 2797.269735813141, 'accumulated_submission_time': 714.4456994533539, 'accumulated_eval_time': 2064.657245874405, 'accumulated_logging_time': 18.162206411361694, 'global_step': 445, 'preemption_count': 0}), (899, {'train/loss': 0.12426039223463944, 'validation/loss': 0.12556893258426965, 'validation/num_examples': 89000000, 'test/loss': 0.1278880137031529, 'test/num_examples': 89274637, 'score': 1254.794733285904, 'total_duration': 4454.71968460083, 'accumulated_submission_time': 1254.794733285904, 'accumulated_eval_time': 3146.4863052368164, 'accumulated_logging_time': 53.4296441078186, 'global_step': 899, 'preemption_count': 0}), (1384, {'train/loss': 0.12422206000074733, 'validation/loss': 0.1251772808988764, 'validation/num_examples': 89000000, 'test/loss': 0.12753689494139303, 'test/num_examples': 89274637, 'score': 1795.5798425674438, 'total_duration': 6103.112063884735, 'accumulated_submission_time': 1795.5798425674438, 'accumulated_eval_time': 4218.598219394684, 'accumulated_logging_time': 88.92007398605347, 'global_step': 1384, 'preemption_count': 0}), (1600, {'train/loss': 0.12387160188227211, 'validation/loss': 0.12506288764044943, 'validation/num_examples': 89000000, 'test/loss': 0.12740793334169478, 'test/num_examples': 89274637, 'score': 2006.7498111724854, 'total_duration': 7418.161320924759, 'accumulated_submission_time': 2006.7498111724854, 'accumulated_eval_time': 5286.28875207901, 'accumulated_logging_time': 125.10662961006165, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0419 06:55:53.465767 140369735386944 submission_runner.py:570] Timing: 2006.7498111724854
I0419 06:55:53.465812 140369735386944 submission_runner.py:571] ====================
I0419 06:55:53.465907 140369735386944 submission_runner.py:631] Final criteo1tb score: 2006.7498111724854
