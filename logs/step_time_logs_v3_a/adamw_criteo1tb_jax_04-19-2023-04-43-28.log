I0419 04:43:48.741162 140551629559616 logger_utils.py:67] Creating experiment directory at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax.
I0419 04:43:48.893803 140551629559616 xla_bridge.py:345] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker: 
I0419 04:43:49.818333 140551629559616 xla_bridge.py:345] Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Interpreter CUDA Host
I0419 04:43:49.819514 140551629559616 xla_bridge.py:345] Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
I0419 04:43:49.823771 140551629559616 submission_runner.py:528] Using RNG seed 1370838436
I0419 04:43:52.488723 140551629559616 submission_runner.py:537] --- Tuning run 1/1 ---
I0419 04:43:52.488925 140551629559616 submission_runner.py:542] Creating tuning directory at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1.
I0419 04:43:52.489203 140551629559616 logger_utils.py:83] Saving hparams to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/hparams.json.
I0419 04:43:52.612603 140551629559616 submission_runner.py:232] Initializing dataset.
I0419 04:43:52.612793 140551629559616 submission_runner.py:239] Initializing model.
I0419 04:43:58.558026 140551629559616 submission_runner.py:249] Initializing optimizer.
I0419 04:44:01.345158 140551629559616 submission_runner.py:256] Initializing metrics bundle.
I0419 04:44:01.345369 140551629559616 submission_runner.py:273] Initializing checkpoint and logger.
I0419 04:44:01.349979 140551629559616 checkpoints.py:466] Found no checkpoint files in /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1 with prefix checkpoint_
I0419 04:44:01.350285 140551629559616 logger_utils.py:230] Unable to record workload.train_mean information. Continuing without it.
I0419 04:44:01.350396 140551629559616 logger_utils.py:230] Unable to record workload.train_stddev information. Continuing without it.
I0419 04:44:02.140962 140551629559616 submission_runner.py:294] Saving meta data to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/meta_data_0.json.
I0419 04:44:02.141930 140551629559616 submission_runner.py:297] Saving flags to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/flags_0.json.
I0419 04:44:02.192744 140551629559616 submission_runner.py:309] Starting training loop.
I0419 04:46:49.391247 140346387318528 logging_writer.py:48] [0] global_step=0, grad_norm=6.438089370727539, loss=0.8440584540367126
I0419 04:46:49.427056 140551629559616 spec.py:298] Evaluating on the training split.
I0419 04:55:50.426046 140551629559616 spec.py:310] Evaluating on the validation split.
I0419 05:00:08.340425 140551629559616 spec.py:326] Evaluating on the test split.
I0419 05:04:52.373296 140551629559616 submission_runner.py:406] Time since start: 1250.18s, 	Step: 1, 	{'train/loss': 0.8438496144051233, 'validation/loss': 0.8405428314606742, 'validation/num_examples': 89000000, 'test/loss': 0.8418685813306639, 'test/num_examples': 89274637, 'score': 167.23411297798157, 'total_duration': 1250.1804642677307, 'accumulated_submission_time': 167.23411297798157, 'accumulated_eval_time': 1082.9461724758148, 'accumulated_logging_time': 0}
I0419 05:04:52.391297 140289351489280 logging_writer.py:48] [1] accumulated_eval_time=1082.946172, accumulated_logging_time=0, accumulated_submission_time=167.234113, global_step=1, preemption_count=0, score=167.234113, test/loss=0.841869, test/num_examples=89274637, total_duration=1250.180464, train/loss=0.843850, validation/loss=0.840543, validation/num_examples=89000000
I0419 05:04:55.261708 140551629559616 checkpoints.py:356] Saving checkpoint at step: 1
I0419 05:05:13.408889 140551629559616 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1
I0419 05:05:13.423921 140551629559616 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1.
I0419 05:06:39.270631 140289343096576 logging_writer.py:48] [100] global_step=100, grad_norm=0.16563241183757782, loss=0.12971290946006775
I0419 05:08:37.700987 140289309525760 logging_writer.py:48] [200] global_step=200, grad_norm=0.035648662596940994, loss=0.12783673405647278
I0419 05:10:36.319811 140289343096576 logging_writer.py:48] [300] global_step=300, grad_norm=0.06596482545137405, loss=0.12753641605377197
I0419 05:12:35.451010 140289309525760 logging_writer.py:48] [400] global_step=400, grad_norm=0.12196816504001617, loss=0.12612660229206085
I0419 05:14:14.185741 140551629559616 spec.py:298] Evaluating on the training split.
I0419 05:24:02.107308 140551629559616 spec.py:310] Evaluating on the validation split.
I0419 05:27:33.535552 140551629559616 spec.py:326] Evaluating on the test split.
I0419 05:31:33.693780 140551629559616 submission_runner.py:406] Time since start: 2851.50s, 	Step: 484, 	{'train/loss': 0.13045652724961485, 'validation/loss': 0.13167823595505618, 'validation/num_examples': 89000000, 'test/loss': 0.13397309025182594, 'test/num_examples': 89274637, 'score': 707.9753642082214, 'total_duration': 2851.500944852829, 'accumulated_submission_time': 707.9753642082214, 'accumulated_eval_time': 2122.4541733264923, 'accumulated_logging_time': 21.065361976623535}
I0419 05:31:33.702984 140288664270592 logging_writer.py:48] [484] accumulated_eval_time=2122.454173, accumulated_logging_time=21.065362, accumulated_submission_time=707.975364, global_step=484, preemption_count=0, score=707.975364, test/loss=0.133973, test/num_examples=89274637, total_duration=2851.500945, train/loss=0.130457, validation/loss=0.131678, validation/num_examples=89000000
I0419 05:31:39.506708 140551629559616 checkpoints.py:356] Saving checkpoint at step: 484
I0419 05:32:11.202833 140551629559616 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_484
I0419 05:32:11.441452 140551629559616 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_484.
I0419 05:32:13.570245 140288655877888 logging_writer.py:48] [500] global_step=500, grad_norm=0.06962349265813828, loss=0.12728963792324066
I0419 05:33:58.922457 140288613914368 logging_writer.py:48] [600] global_step=600, grad_norm=0.04589445888996124, loss=0.12704665958881378
I0419 05:35:54.167932 140288655877888 logging_writer.py:48] [700] global_step=700, grad_norm=0.045071691274642944, loss=0.12512478232383728
I0419 05:37:49.501002 140288613914368 logging_writer.py:48] [800] global_step=800, grad_norm=0.03818953409790993, loss=0.12675657868385315
I0419 05:39:46.070735 140288655877888 logging_writer.py:48] [900] global_step=900, grad_norm=0.01276270393282175, loss=0.12367495149374008
I0419 05:41:11.745742 140551629559616 spec.py:298] Evaluating on the training split.
I0419 05:51:08.925489 140551629559616 spec.py:310] Evaluating on the validation split.
I0419 05:54:59.511844 140551629559616 spec.py:326] Evaluating on the test split.
I0419 05:59:47.231139 140551629559616 submission_runner.py:406] Time since start: 4545.04s, 	Step: 975, 	{'train/loss': 0.12463056663979144, 'validation/loss': 0.12600730337078653, 'validation/num_examples': 89000000, 'test/loss': 0.12824178719427334, 'test/num_examples': 89274637, 'score': 1247.981793642044, 'total_duration': 4545.038080453873, 'accumulated_submission_time': 1247.981793642044, 'accumulated_eval_time': 3237.9392881393433, 'accumulated_logging_time': 59.10496473312378}
I0419 05:59:47.241199 140281131292416 logging_writer.py:48] [975] accumulated_eval_time=3237.939288, accumulated_logging_time=59.104965, accumulated_submission_time=1247.981794, global_step=975, preemption_count=0, score=1247.981794, test/loss=0.128242, test/num_examples=89274637, total_duration=4545.038080, train/loss=0.124631, validation/loss=0.126007, validation/num_examples=89000000
I0419 05:59:53.034962 140551629559616 checkpoints.py:356] Saving checkpoint at step: 975
I0419 06:00:22.367836 140551629559616 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_975
I0419 06:00:22.578713 140551629559616 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_975.
I0419 06:00:25.677915 140281122899712 logging_writer.py:48] [1000] global_step=1000, grad_norm=0.010018330998718739, loss=0.12425490468740463
I0419 06:02:21.811491 140280997074688 logging_writer.py:48] [1100] global_step=1100, grad_norm=0.0069726803340017796, loss=0.12544387578964233
I0419 06:04:17.724105 140281122899712 logging_writer.py:48] [1200] global_step=1200, grad_norm=0.03258155658841133, loss=0.1246347725391388
I0419 06:06:15.294006 140280997074688 logging_writer.py:48] [1300] global_step=1300, grad_norm=0.007025540340691805, loss=0.12401360273361206
I0419 06:08:09.912979 140281122899712 logging_writer.py:48] [1400] global_step=1400, grad_norm=0.017100244760513306, loss=0.12299580872058868
I0419 06:09:23.879483 140551629559616 spec.py:298] Evaluating on the training split.
I0419 06:19:09.585210 140551629559616 spec.py:310] Evaluating on the validation split.
I0419 06:22:52.008081 140551629559616 spec.py:326] Evaluating on the test split.
I0419 06:27:08.382407 140551629559616 submission_runner.py:406] Time since start: 6186.19s, 	Step: 1466, 	{'train/loss': 0.12400794292391004, 'validation/loss': 0.12530267415730337, 'validation/num_examples': 89000000, 'test/loss': 0.1277399985395628, 'test/num_examples': 89274637, 'score': 1788.9715433120728, 'total_duration': 6186.189535140991, 'accumulated_submission_time': 1788.9715433120728, 'accumulated_eval_time': 4302.44211769104, 'accumulated_logging_time': 94.75751423835754}
I0419 06:27:08.390573 140280997074688 logging_writer.py:48] [1466] accumulated_eval_time=4302.442118, accumulated_logging_time=94.757514, accumulated_submission_time=1788.971543, global_step=1466, preemption_count=0, score=1788.971543, test/loss=0.127740, test/num_examples=89274637, total_duration=6186.189535, train/loss=0.124008, validation/loss=0.125303, validation/num_examples=89000000
I0419 06:27:14.243948 140551629559616 checkpoints.py:356] Saving checkpoint at step: 1466
I0419 06:27:45.687761 140551629559616 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1466
I0419 06:27:45.929991 140551629559616 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1466.
I0419 06:27:58.191882 140281122899712 logging_writer.py:48] [1500] global_step=1500, grad_norm=0.015283079817891121, loss=0.12449770420789719
I0419 06:29:51.610093 140551629559616 spec.py:298] Evaluating on the training split.
I0419 06:39:42.658116 140551629559616 spec.py:310] Evaluating on the validation split.
I0419 06:43:23.836349 140551629559616 spec.py:326] Evaluating on the test split.
I0419 06:47:40.497327 140551629559616 submission_runner.py:406] Time since start: 7418.30s, 	Step: 1600, 	{'train/loss': 0.12403667525739859, 'validation/loss': 0.12521634831460673, 'validation/num_examples': 89000000, 'test/loss': 0.1276015269600032, 'test/num_examples': 89274637, 'score': 1914.3718683719635, 'total_duration': 7418.304415941238, 'accumulated_submission_time': 1914.3718683719635, 'accumulated_eval_time': 5371.3292117118835, 'accumulated_logging_time': 132.58314204216003}
I0419 06:47:40.505820 140279143171840 logging_writer.py:48] [1600] accumulated_eval_time=5371.329212, accumulated_logging_time=132.583142, accumulated_submission_time=1914.371868, global_step=1600, preemption_count=0, score=1914.371868, test/loss=0.127602, test/num_examples=89274637, total_duration=7418.304416, train/loss=0.124037, validation/loss=0.125216, validation/num_examples=89000000
I0419 06:47:45.971378 140551629559616 checkpoints.py:356] Saving checkpoint at step: 1600
I0419 06:48:19.197078 140551629559616 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600
I0419 06:48:19.518826 140551629559616 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0419 06:48:19.828649 140279134779136 logging_writer.py:48] [1600] global_step=1600, preemption_count=0, score=1914.371868
I0419 06:48:25.111732 140551629559616 checkpoints.py:356] Saving checkpoint at step: 1600
I0419 06:49:04.892393 140551629559616 checkpoints.py:317] Saved checkpoint at /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600
I0419 06:49:05.209619 140551629559616 checkpoint_utils.py:240] Saved checkpoint to /experiment_runs/timing_v3/timing_adamw/criteo1tb_jax/trial_1/checkpoint_1600.
I0419 06:50:32.718646 140551629559616 submission_runner.py:567] Tuning trial 1/1
I0419 06:50:32.720003 140551629559616 submission_runner.py:568] Hyperparameters: Hyperparameters(learning_rate=0.0019814680146414726, one_minus_beta1=0.22838767981804783, beta2=0.999, warmup_factor=0.05, weight_decay=0.010340635370188849, label_smoothing=0.1, dropout_rate=0.0)
I0419 06:50:32.721445 140551629559616 submission_runner.py:569] Metrics: {'eval_results': [(1, {'train/loss': 0.8438496144051233, 'validation/loss': 0.8405428314606742, 'validation/num_examples': 89000000, 'test/loss': 0.8418685813306639, 'test/num_examples': 89274637, 'score': 167.23411297798157, 'total_duration': 1250.1804642677307, 'accumulated_submission_time': 167.23411297798157, 'accumulated_eval_time': 1082.9461724758148, 'accumulated_logging_time': 0, 'global_step': 1, 'preemption_count': 0}), (484, {'train/loss': 0.13045652724961485, 'validation/loss': 0.13167823595505618, 'validation/num_examples': 89000000, 'test/loss': 0.13397309025182594, 'test/num_examples': 89274637, 'score': 707.9753642082214, 'total_duration': 2851.500944852829, 'accumulated_submission_time': 707.9753642082214, 'accumulated_eval_time': 2122.4541733264923, 'accumulated_logging_time': 21.065361976623535, 'global_step': 484, 'preemption_count': 0}), (975, {'train/loss': 0.12463056663979144, 'validation/loss': 0.12600730337078653, 'validation/num_examples': 89000000, 'test/loss': 0.12824178719427334, 'test/num_examples': 89274637, 'score': 1247.981793642044, 'total_duration': 4545.038080453873, 'accumulated_submission_time': 1247.981793642044, 'accumulated_eval_time': 3237.9392881393433, 'accumulated_logging_time': 59.10496473312378, 'global_step': 975, 'preemption_count': 0}), (1466, {'train/loss': 0.12400794292391004, 'validation/loss': 0.12530267415730337, 'validation/num_examples': 89000000, 'test/loss': 0.1277399985395628, 'test/num_examples': 89274637, 'score': 1788.9715433120728, 'total_duration': 6186.189535140991, 'accumulated_submission_time': 1788.9715433120728, 'accumulated_eval_time': 4302.44211769104, 'accumulated_logging_time': 94.75751423835754, 'global_step': 1466, 'preemption_count': 0}), (1600, {'train/loss': 0.12403667525739859, 'validation/loss': 0.12521634831460673, 'validation/num_examples': 89000000, 'test/loss': 0.1276015269600032, 'test/num_examples': 89274637, 'score': 1914.3718683719635, 'total_duration': 7418.304415941238, 'accumulated_submission_time': 1914.3718683719635, 'accumulated_eval_time': 5371.3292117118835, 'accumulated_logging_time': 132.58314204216003, 'global_step': 1600, 'preemption_count': 0})], 'global_step': 1600}
I0419 06:50:32.721545 140551629559616 submission_runner.py:570] Timing: 1914.3718683719635
I0419 06:50:32.721592 140551629559616 submission_runner.py:571] ====================
I0419 06:50:32.721688 140551629559616 submission_runner.py:631] Final criteo1tb score: 1914.3718683719635
